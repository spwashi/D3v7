(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const br="spwashi-datum-";function fi(e){return br+e%13}function di(e){document.body.dataset.dataindex=e,window.spwashi.onDataIndexChange(e)}function ge(){return parseInt((document.body.dataset.dataindex||"0").split("-").reverse()[0])}const hi=()=>window.spwashi.parameters.mode,L=(e,t=!0,n=!1)=>{t&&hi()===e&&(e=null),window.spwashi.parameters.mode=e,document.body.dataset.mode=e,window.spwashi.onModeChange(e,n)};function Sr(e){const t=document.querySelector("#mainmenu-shortcuts ol");t.innerHTML="",window.spwashi.modeOrder.forEach(n=>{const i=document.createElement("li");i.dataset.modeAction=n,i.dataset.interfaceElement="main-menu";const r=document.createElement("button");r.id=`mode-selector--${n}`,r.innerText=n,i.appendChild(r),t.appendChild(i)}),window.spwashi.modeOrder.forEach(n=>{const i=document.querySelector(`#mode-selector--${n}`);i.onclick=()=>{L(hi()===n?null:n)}}),L(e)}function Nr(){window.spwashi.parameters=window.spwashi.parameters||{},window.spwashi.parameters.debug=!1,window.spwashi.parameters.perspective=window.spwashi.parameters.perspective||void 0,window.spwashi.parameters.dataIndex=window.spwashi.parameters.dataIndex||null,window.spwashi.parameters.width=window.spwashi.parameters.width||window.innerWidth*.9,window.spwashi.parameters.height=window.spwashi.parameters.height||window.innerHeight*.9,window.spwashi.parameters.startPos=window.spwashi.parameters.startPos||{},window.spwashi.parameters.startPos.x=window.spwashi.parameters.startPos.x||window.spwashi.parameters.width/2,window.spwashi.parameters.startPos.y=window.spwashi.parameters.startPos.y||window.spwashi.parameters.height/2,window.spwashi.parameters.links=window.spwashi.parameters.links||{},window.spwashi.parameters.links.strength=window.spwashi.parameters.links.strength||.1,window.spwashi.parameters.nodes=window.spwashi.parameters.nodes||{},window.spwashi.parameters.nodes.count=window.spwashi.parameters.nodes.count||13,window.spwashi.parameters.nodes.radiusMultiplier=window.spwashi.parameters.nodes.radiusMultiplier||30,window.spwashi.parameters.forces=window.spwashi.parameters.forces||{},window.spwashi.parameters.forces.alpha=window.spwashi.parameters.forces.alpha||1,window.spwashi.parameters.forces.alphaTarget=window.spwashi.parameters.forces.alphaTarget||.3,window.spwashi.parameters.forces.alphaDecay=window.spwashi.parameters.forces.alphaDecay||.03,window.spwashi.parameters.forces.velocityDecay=window.spwashi.parameters.forces.velocityDecay||.91,window.spwashi.parameters.forces.charge=window.spwashi.parameters.forces.charge||10,window.spwashi.parameters.forces.centerStrength=window.spwashi.parameters.forces.centerStrength||1,window.spwashi.parameters.forces.boundingBox=typeof window.spwashi.parameters.forces.boundingBox<"u"?window.spwashi.parameters.forces.boundingBox:!0,window.spwashi.parameters.forces.centerPos=window.spwashi.parameters.forces.centerPos||{},window.spwashi.parameters.forces.centerPos.x=window.spwashi.parameters.forces.centerPos.x||window.spwashi.parameters.startPos.x,window.spwashi.parameters.forces.centerPos.y=window.spwashi.parameters.forces.centerPos.y||window.spwashi.parameters.startPos.y}function ze(e){var i;[...e.entries()].forEach(([r,o])=>(document.querySelector(`[name=${r}]`)||{}).value=o),window.spwashi.parameters=window.spwashi.parameters||{},window.spwashi.values=window.spwashi.values||{},window.spwashi.values.fy=[],window.spwashi.values.r=[],window.spwashi.values.text=window.spwashi.values.text||{},window.spwashi.values.text.fontSize=window.spwashi.values.text.fontSize||[],window.spwashi.superpower=window.spwashi.superpower||{name:"hyperlink",intent:1},window.spwashi.parameters.links=window.spwashi.parameters.links||{},window.spwashi.parameters.forces=window.spwashi.parameters.forces||{},window.spwashi.featuredIdentity=((i=/\/identity\/([a-zA-Z\d]+)/.exec(window.location.href))==null?void 0:i[1])||e.get("identity");const t=`spwashi.parameters#${window.spwashi.featuredIdentity}`;window.spwashi.parameterKey=t,console.log({parameterKey:t});let n;if(e.get("title")&&(document.title=e.get("title"),document.querySelector("h1").innerText=e.get("title")),e.has("perspective")&&(window.spwashi.parameters.perspective=e.get("perspective")!=="0"),e.has("display")&&(document.body.dataset.displaymode=e.get("display")),e.has("reset")&&window.localStorage.clear(),e.has("nodeCount")&&(window.spwashi.parameters.nodes=window.spwashi.parameters.nodes||{},window.spwashi.parameters.nodes.count=+e.get("nodeCount")),e.has("linkStrength")&&(window.spwashi.parameters.links.strength=+e.get("linkStrength")),e.has("charge")&&(window.spwashi.parameters.forces.charge=+e.get("charge")),e.has("linkStyle")?window.spwashi.parameters.links.linkPrev=e.get("linkStyle")==="prev":window.spwashi.parameters.links.linkPrev=0,e.has("width")&&(window.spwashi.parameters.width=+e.get("width")),e.has("size")&&(window.spwashi.parameters.width=+e.get("size").split(",")[0],window.spwashi.parameters.height=+e.get("size").split(",")[0]),e.has("height")&&(window.spwashi.parameters.height=+e.get("height")),e.has("centerStrength"),e.has("center")){let[r,o]=e.get("center").split(",").map(s=>+s);o=o||r,window.spwashi.parameters.startPos={x:r,y:o},window.spwashi.parameters.forces.centerPos={x:r,y:o}}else{let[r,o]=[window.spwashi.parameters.width,window.spwashi.parameters.height].map(s=>s/2);window.spwashi.parameters.startPos={x:r,y:o},window.spwashi.parameters.forces.centerPos={x:r,y:o}}e.has("alpha")&&(window.spwashi.parameters.forces.alpha=+e.get("alpha")),e.has("alphaTarget")&&(window.spwashi.parameters.forces.alphaTarget=+e.get("alphaTarget")),e.has("alphaDecay")&&(window.spwashi.parameters.forces.alphaDecay=+e.get("alphaDecay")),e.has("velocityDecay")&&(window.spwashi.parameters.forces.velocityDecay=+e.get("velocityDecay")),e.has("zoom")?window.spwashi.parameters.canzoom=!!+e.get("zoom"):window.spwashi.parameters.canzoom=!0,e.has("superpower")&&(window.spwashi.superpower.name=e.get("superpower")),e.has("intent")&&(window.spwashi.superpower.intent=parseInt(e.get("intent")||1)),e.has("mode")&&(n=e.get("mode"),setTimeout(()=>L(n,!1),500)),e.has("fx")&&(window.spwashi.values.fx=e.get("fx").split(",").map(r=>+r)),e.has("fy")&&(window.spwashi.values.fy=e.get("fy").split(",").map(r=>+r)),e.has("r")&&(window.spwashi.values.r=e.get("r").split(",").map(r=>+r)),e.has("defaultRadius")&&(window.spwashi.parameters.nodes.radiusMultiplier=+e.get("defaultRadius")),e.has("fontSize")&&(window.spwashi.values.text.fontSize=e.get("fontSize").split(",").map(r=>+r)),e.has("doFetch")&&(window.spwashi.doFetchNodes=e.get("dofetch")==="1"),e.has("boundingBox")&&(window.spwashi.parameters.forces.boundingBox=e.get("boundingBox")==="1"),e.has("dataindex")&&(window.spwashi.parameters.dataIndex=+e.get("dataindex"),di(fi(window.spwashi.parameters.dataIndex))),e.has("debug")&&(window.spwashi.parameters.debug=!0,document.body.dataset.debug="debug"),window.spwashi.initialMode=n}let K;const ne={ready:!0},U={x:0,y:0,queuedAction:()=>{const e=window.spwashi.getItem("mode","focal.root");L(e)},onFocus:()=>{}};function xn(e,t=500){e.classList.add("consent-to-engage");const n={interested:null,revoke:r},i=setTimeout(()=>{e.classList.remove("consent-to-engage"),e.classList.add("consented-to-engage"),n.interested=!0},t);function r(){clearTimeout(i),e.classList.remove("consented-to-engage"),e.classList.remove("consent-to-engage"),n.interested=!1}return n}function Pe(){if(!K){K=document.querySelector("#focal-square");const e=window.spwashi.getItem("focalPoint","focal.root");e&&(Object.assign(U,e),Ae(U,!0)),K.onmousedown=t=>{t.preventDefault();const n=xn(K,100);document.documentElement.onmousemove=i=>{n.interested&&(i.preventDefault(),ne.ready=!1,Ae({x:i.x,y:i.y},!0))},document.documentElement.onmouseup=i=>{i.preventDefault(),n.revoke(),ne.ready||setTimeout(()=>ne.ready=!0,100),document.documentElement.onmousemove=null,document.documentElement.onmouseup=null}},K.ontouchstart=t=>{t.preventDefault();const n=xn(K,300);document.documentElement.ontouchmove=i=>{i.preventDefault(),n.interested&&(ne.ready=!1,Ae({x:i.touches[0].clientX,y:i.touches[0].clientY},!0))},document.documentElement.ontouchend=i=>{i.preventDefault(),n.interested||(ne.ready=!0,K.onclick(i)),n.revoke(),ne.ready||setTimeout(()=>ne.ready=!0,100),document.documentElement.ontouchmove=null,document.documentElement.ontouchend=null}}}return K.onclick=e=>{ne.ready&&U.queuedAction()},K.onfocus=e=>{U.onFocus()},K}function Ae({x:e,y:t},n=!1){U.x=e,U.y=t,n&&(U.fx=e,U.fy=t),document.documentElement.style.setProperty("--focal-x",e+"px"),document.documentElement.style.setProperty("--focal-y",t+"px"),window.spwashi.setItem("focalPoint",{x:e,y:t,fx:e,fy:t},"focal.root")}document.documentElement.style.setProperty("--focal-y-basis",document.documentElement.getBoundingClientRect().height+"px");function Cr(e){const t=e.getBoundingClientRect().x,n=e.getBoundingClientRect().y,i=e.getBoundingClientRect().width,r=e.getBoundingClientRect().height,o=t+i,s=n+r;(U.fx===void 0||U.fy===void 0)&&Ae({x:o,y:s})}function z(...e){window.spwashi.nodes.push(...e)}function pi(e){return window.spwashi.nodes.map(e)}function D(e){window.spwashi.nodes.forEach(e)}const Mr=["thoughts are nodes","text can be linked"];function wi(e){z(...[{id:"help--home",name:"home",description:"go to home page",r:30,url:"/"}].map(n=>(n.fy=e,n))),window.spwashi.reinit()}function Er(e){{window.spwashi.setItem("help",Mr.join(`
`),"focal.root"),z({fx:window.spwashi.parameters.startPos.x,fy:window.spwashi.parameters.startPos.y,id:"help",name:"help",kind:"__help",r:30,collisionRadius:100,charge:-100,url:"/help",callbacks:{click(t,n){n.fx=n.fy=void 0;const i=n.y;n.x,wi(i)}}}),e.physicsChange=!0;return}}function Ar(){window.spwashi.callbacks=window.spwashi.callbacks||{},window.spwashi.callbacks.arrowRight=()=>{},window.spwashi.callbacks.arrowLeft=()=>{},window.spwashi.callbacks.arrowUp=()=>{},window.spwashi.callbacks.arrowDown=()=>{}}function Tr(){document.body.addEventListener("mousedown",e=>{e.target.tagName!=="BUTTON"&&e.target.tagName!=="CIRCLE"&&document.body.dataset.interfaceDepth==="standard"&&Pe()},!0)}function se(e,...t){return e.push(...t),e}function gi(e){const t=[],n=window.spwashi.parameters.links.strength;let i=!1;for(let r of e){if(!(r.identity&&r.parts))continue;const{head:o,body:s,tail:a}=r.parts;[o,s,a].flat().map(c=>c==null?void 0:c.identity).filter(Boolean).forEach(c=>{const l=typeof c=="string"?c:c.identity,f=!!window.spwashi.parameters.perspective,d=window.spwashi.getNode(l,f?r.colorindex:void 0);if(!d){i=!0;return}let h=1;switch(d.kind.trim()){case"operator + delimiter + essential.open":case"operator + delimiter + essential.close":h=5;break;case"operator + delimiter + locational.open":case"operator + delimiter + locational.close":h=5;break;case"operator + delimiter + conceptual.open":case"operator + delimiter + conceptual.close":h=5;break}switch(r.kind.trim()){case"phrasal":h=7;break}const m=n*h,p={source:d.id,target:r.id,strength:m};se(t,p)})}return i&&console.error(e),t}function md(e){return window.spwashi.nodes.filter((t,n)=>!e(t,n))}function H(){return window.spwashi.nodes}const vn="center";let bt=null;function Ir(){return bt=bt||{identity:vn,r:0,collisionRadius:100,x:window.spwashi.parameters.width/2,y:window.spwashi.parameters.height/2},z(bt),vn}function Or(e){const t=Ir();window.spwashi.reinit();const n=[];for(let i of e){const r={source:i.id,target:window.spwashi.getNode(t).id,strength:.1};se(n,r)}return n}const Dr="spwashi-action-";function $r(e){return Dr+e}function Rr(){window.spwashi.boon=()=>{async function*u(l=100,f=window.spwashi.parameters.nodes.count){for(let d=0;d<f;d++)yield d,await new Promise(h=>setTimeout(h,l))}async function c(){let l=[];for await(const f of u()){const d={name:"#",r:30,color:"wheat",colorindex:ge()};z(d),window.spwashi.reinit(),l.push(d)}return l}return c()},window.spwashi.bane=u=>{async function*c(f,d){let h=u||H();for(let m=100;m--;m>0)for(let p of h)yield p,await new Promise(w=>setTimeout(w,f))}async function l(){let f=[];for await(const d of c(10))d.r=Math.min(d.r*Math.random(),100),d.r=Math.max(d.r*Math.random(),10);return f}return l()},window.spwashi.bone=()=>{const u=new Map;for(let c of window.spwashi.nodes){const l=u.get(c.colorindex)||[];l.push(c),u.set(c.colorindex,l)}[...u.values()].forEach(c=>{let l,f;for(let d of c){f=f||d;let h=window.spwashi.getNode(l==null?void 0:l.id),m=window.spwashi.getNode(d.id);const p={source:m,target:h,colorindex:m.colorindex,strength:window.spwashi.parameters.links.strength*.3};m&&se(window.spwashi.links,p),l=d}se(window.spwashi.links,{source:l==null?void 0:l.id,target:f==null?void 0:f.id,strength:window.spwashi.parameters.links.strength*.3})}),window.spwashi.reinit()},window.spwashi.bonk=u=>{(u||window.spwashi.nodes).forEach(c=>(c.color=void 0,c.colorindex+=1)),window.spwashi.reinit()},window.spwashi.honk=()=>{window.spwashi.links.forEach(u=>u.strength*=1.5),window.spwashi.reinit()};const o=[{title:"Lore",reflexes:[["boon",()=>{window.spwashi.boon()}],["bone",()=>{window.spwashi.bone()}],["honk",()=>{window.spwashi.honk()}],["bane",()=>{window.spwashi.bane(),window.spwashi.reinit()}],["bonk",()=>{window.spwashi.bonk()}]]},{title:"Set Charge",reflexes:[["-100",()=>{window.spwashi.parameters.forces.charge=-100,window.spwashi.reinit()}],["0",()=>{window.spwashi.parameters.forces.charge=0,window.spwashi.reinit()}],["100",()=>{window.spwashi.parameters.forces.charge=100,window.spwashi.reinit()}],["-1k",()=>{window.spwashi.parameters.forces.charge=-1e3,window.spwashi.reinit()}],["-10k",()=>{window.spwashi.parameters.forces.charge=-1e4,window.spwashi.reinit()}]]},{title:"Adjust Radius",reflexes:[["*=3.2",()=>{D(u=>u.r*=3.2),window.spwashi.reinit()}],["/=2.3",()=>{D(u=>u.r/=2.3),window.spwashi.reinit()}],["=10",()=>{D(u=>u.r=10),window.spwashi.reinit()}]]},{title:"Adjust Charge",reflexes:[["-100",()=>{window.spwashi.parameters.forces.charge-=100,window.spwashi.reinit()}],["-10",()=>{window.spwashi.parameters.forces.charge-=10,window.spwashi.reinit()}],["*-1",()=>{window.spwashi.parameters.forces.charge*=-1,window.spwashi.reinit()}],["+10",()=>{window.spwashi.parameters.forces.charge+=10,window.spwashi.reinit()}],["*13",()=>{window.spwashi.parameters.forces.charge*=10,window.spwashi.reinit()}]]},{title:"Forces",reflexes:[["link",()=>{const u=[Or,gi],c=window.spwashi.__session.i++,l=u[c%u.length];window.spwashi.links=l(window.spwashi.nodes),window.spwashi.reinit()}],["speed decay",()=>{const u=["0.1","0.2","0.3","0.4","0.5"],c=window.spwashi.__session.i++;window.spwashi.parameters.forces.velocityDecay=u[c%u.length],window.spwashi.reinit()}],["box",()=>{window.spwashi.parameters.forces.boundingBox=!window.spwashi.parameters.forces.boundingBox,window.spwashi.reinit()}]]}],s=document.querySelector("#reflexes");let a=0;o.forEach(({title:u,reflexes:c})=>{const l=s.appendChild(document.createElement("section"));l.classList.add("card");const f=l.appendChild(document.createElement("header"));f.classList.add("card-header");const d=l.appendChild(document.createElement("div"));d.classList.add("card-body");const h=d.appendChild(document.createElement("div"));h.classList.add("button-container"),f.innerText=u,c.forEach(m=>{const p=h.appendChild(document.createElement("button"));p.innerText=m[0],p.onclick=()=>{m[1](),L(null),document.querySelector("#mode-selector--reflex").focus()},p.dataset.actionindex=$r(a++)})})}function Lr(){document.querySelector("#reflexes button").focus();const e=document.querySelectorAll("#reflexes button"),t={},n={};e.forEach(i=>{const r=i.getBoundingClientRect(),o=Math.round(r.x),s=Math.round(r.y);t[o]||(t[o]=[]),n[s]||(n[s]=[]),t[o].push(i),n[s].push(i)}),window.spwashi.callbacks.arrowLeft=()=>{const i=document.activeElement,r=Math.round(i.getBoundingClientRect().y),o=n[r],s=o.indexOf(i),a=o[s-1]||o[o.length-1];a&&a.focus()},window.spwashi.callbacks.arrowRight=()=>{const i=document.activeElement,r=Math.round(i.getBoundingClientRect().y),o=n[r],s=o.indexOf(i),a=o[s+1]||o[0];a&&a.focus()},window.spwashi.callbacks.arrowUp=()=>{const i=document.activeElement,r=Math.round(i.getBoundingClientRect().x),o=t[r],s=o.indexOf(i),a=o[s+1]||o[0];a&&a.focus()},window.spwashi.callbacks.arrowDown=()=>{const i=document.activeElement,r=Math.round(i.getBoundingClientRect().x),o=t[r],s=o.indexOf(i),a=o[s-1]||o[o.length-1];a&&a.focus()}}function zr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var mi={exports:{}},yi={exports:{}};(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(n,i){return n<<i|n>>>32-i},rotr:function(n,i){return n<<32-i|n>>>i},endian:function(n){if(n.constructor==Number)return t.rotl(n,8)&16711935|t.rotl(n,24)&4278255360;for(var i=0;i<n.length;i++)n[i]=t.endian(n[i]);return n},randomBytes:function(n){for(var i=[];n>0;n--)i.push(Math.floor(Math.random()*256));return i},bytesToWords:function(n){for(var i=[],r=0,o=0;r<n.length;r++,o+=8)i[o>>>5]|=n[r]<<24-o%32;return i},wordsToBytes:function(n){for(var i=[],r=0;r<n.length*32;r+=8)i.push(n[r>>>5]>>>24-r%32&255);return i},bytesToHex:function(n){for(var i=[],r=0;r<n.length;r++)i.push((n[r]>>>4).toString(16)),i.push((n[r]&15).toString(16));return i.join("")},hexToBytes:function(n){for(var i=[],r=0;r<n.length;r+=2)i.push(parseInt(n.substr(r,2),16));return i},bytesToBase64:function(n){for(var i=[],r=0;r<n.length;r+=3)for(var o=n[r]<<16|n[r+1]<<8|n[r+2],s=0;s<4;s++)r*8+s*6<=n.length*8?i.push(e.charAt(o>>>6*(3-s)&63)):i.push("=");return i.join("")},base64ToBytes:function(n){n=n.replace(/[^A-Z0-9+\/]/ig,"");for(var i=[],r=0,o=0;r<n.length;o=++r%4)o!=0&&i.push((e.indexOf(n.charAt(r-1))&Math.pow(2,-2*o+8)-1)<<o*2|e.indexOf(n.charAt(r))>>>6-o*2);return i}};yi.exports=t})();var Pr=yi.exports,Tt={utf8:{stringToBytes:function(e){return Tt.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(Tt.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n)&255);return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}},kn=Tt;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Fr=function(e){return e!=null&&(xi(e)||Br(e)||!!e._isBuffer)};function xi(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function Br(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&xi(e.slice(0,0))}(function(){var e=Pr,t=kn.utf8,n=Fr,i=kn.bin,r=function(o,s){o.constructor==String?s&&s.encoding==="binary"?o=i.stringToBytes(o):o=t.stringToBytes(o):n(o)?o=Array.prototype.slice.call(o,0):!Array.isArray(o)&&o.constructor!==Uint8Array&&(o=o.toString());for(var a=e.bytesToWords(o),u=o.length*8,c=1732584193,l=-271733879,f=-1732584194,d=271733878,h=0;h<a.length;h++)a[h]=(a[h]<<8|a[h]>>>24)&16711935|(a[h]<<24|a[h]>>>8)&4278255360;a[u>>>5]|=128<<u%32,a[(u+64>>>9<<4)+14]=u;for(var m=r._ff,p=r._gg,w=r._hh,y=r._ii,h=0;h<a.length;h+=16){var x=c,b=l,g=f,k=d;c=m(c,l,f,d,a[h+0],7,-680876936),d=m(d,c,l,f,a[h+1],12,-389564586),f=m(f,d,c,l,a[h+2],17,606105819),l=m(l,f,d,c,a[h+3],22,-1044525330),c=m(c,l,f,d,a[h+4],7,-176418897),d=m(d,c,l,f,a[h+5],12,1200080426),f=m(f,d,c,l,a[h+6],17,-1473231341),l=m(l,f,d,c,a[h+7],22,-45705983),c=m(c,l,f,d,a[h+8],7,1770035416),d=m(d,c,l,f,a[h+9],12,-1958414417),f=m(f,d,c,l,a[h+10],17,-42063),l=m(l,f,d,c,a[h+11],22,-1990404162),c=m(c,l,f,d,a[h+12],7,1804603682),d=m(d,c,l,f,a[h+13],12,-40341101),f=m(f,d,c,l,a[h+14],17,-1502002290),l=m(l,f,d,c,a[h+15],22,1236535329),c=p(c,l,f,d,a[h+1],5,-165796510),d=p(d,c,l,f,a[h+6],9,-1069501632),f=p(f,d,c,l,a[h+11],14,643717713),l=p(l,f,d,c,a[h+0],20,-373897302),c=p(c,l,f,d,a[h+5],5,-701558691),d=p(d,c,l,f,a[h+10],9,38016083),f=p(f,d,c,l,a[h+15],14,-660478335),l=p(l,f,d,c,a[h+4],20,-405537848),c=p(c,l,f,d,a[h+9],5,568446438),d=p(d,c,l,f,a[h+14],9,-1019803690),f=p(f,d,c,l,a[h+3],14,-187363961),l=p(l,f,d,c,a[h+8],20,1163531501),c=p(c,l,f,d,a[h+13],5,-1444681467),d=p(d,c,l,f,a[h+2],9,-51403784),f=p(f,d,c,l,a[h+7],14,1735328473),l=p(l,f,d,c,a[h+12],20,-1926607734),c=w(c,l,f,d,a[h+5],4,-378558),d=w(d,c,l,f,a[h+8],11,-2022574463),f=w(f,d,c,l,a[h+11],16,1839030562),l=w(l,f,d,c,a[h+14],23,-35309556),c=w(c,l,f,d,a[h+1],4,-1530992060),d=w(d,c,l,f,a[h+4],11,1272893353),f=w(f,d,c,l,a[h+7],16,-155497632),l=w(l,f,d,c,a[h+10],23,-1094730640),c=w(c,l,f,d,a[h+13],4,681279174),d=w(d,c,l,f,a[h+0],11,-358537222),f=w(f,d,c,l,a[h+3],16,-722521979),l=w(l,f,d,c,a[h+6],23,76029189),c=w(c,l,f,d,a[h+9],4,-640364487),d=w(d,c,l,f,a[h+12],11,-421815835),f=w(f,d,c,l,a[h+15],16,530742520),l=w(l,f,d,c,a[h+2],23,-995338651),c=y(c,l,f,d,a[h+0],6,-198630844),d=y(d,c,l,f,a[h+7],10,1126891415),f=y(f,d,c,l,a[h+14],15,-1416354905),l=y(l,f,d,c,a[h+5],21,-57434055),c=y(c,l,f,d,a[h+12],6,1700485571),d=y(d,c,l,f,a[h+3],10,-1894986606),f=y(f,d,c,l,a[h+10],15,-1051523),l=y(l,f,d,c,a[h+1],21,-2054922799),c=y(c,l,f,d,a[h+8],6,1873313359),d=y(d,c,l,f,a[h+15],10,-30611744),f=y(f,d,c,l,a[h+6],15,-1560198380),l=y(l,f,d,c,a[h+13],21,1309151649),c=y(c,l,f,d,a[h+4],6,-145523070),d=y(d,c,l,f,a[h+11],10,-1120210379),f=y(f,d,c,l,a[h+2],15,718787259),l=y(l,f,d,c,a[h+9],21,-343485551),c=c+x>>>0,l=l+b>>>0,f=f+g>>>0,d=d+k>>>0}return e.endian([c,l,f,d])};r._ff=function(o,s,a,u,c,l,f){var d=o+(s&a|~s&u)+(c>>>0)+f;return(d<<l|d>>>32-l)+s},r._gg=function(o,s,a,u,c,l,f){var d=o+(s&u|a&~u)+(c>>>0)+f;return(d<<l|d>>>32-l)+s},r._hh=function(o,s,a,u,c,l,f){var d=o+(s^a^u)+(c>>>0)+f;return(d<<l|d>>>32-l)+s},r._ii=function(o,s,a,u,c,l,f){var d=o+(a^(s|~u))+(c>>>0)+f;return(d<<l|d>>>32-l)+s},r._blocksize=16,r._digestsize=16,mi.exports=function(o,s){if(o==null)throw new Error("Illegal argument "+o);var a=e.wordsToBytes(r(o,s));return s&&s.asBytes?a:s&&s.asString?i.bytesToString(a):e.bytesToHex(a)}})();var qr=mi.exports;const vi=zr(qr);function It(){const e=window.location.href.split("?")[1]||"",t=new URLSearchParams(e),n=new URLSearchParams;return t.has("title ")&&n.set("title",t.get("title")),t.has("size")&&n.set("size",t.get("size")),t.has("superpower")&&n.set("superpower",t.get("superpower")),n}function B(e){var t;return(t=e.kind)==null?void 0:t.trim().split(" + ").reverse()[0]}function Hr(e){var t;return(t=e.kind)==null?void 0:t.split(" + ")[0]}function ie(e){return e.kind.split(" + ").includes("operator")}function Ot(e,t,n=void 0){return t.set("title",n),`/identity/${e}?${t.toString()}`}function ki(e){return e.md5=e.md5||e.identity&&vi(e.identity)}function Fe(e,t){var C,S,E,M,_,A;if(e.getUrl=()=>{const v=It();v.set("superpower","hyperlink");const I=e.md5,W=Ot(I,v,e.identity);return e.url=W,W},e.processed||(e.processed=Date.now(),!e.identity))return e;const n=e.head,i=e.body,r=e.tail;delete e.head,delete e.body,delete e.tail,e.parts={head:n,body:i,tail:r};const o=((C=window.spwashi.values.fx)==null?void 0:C[t])||e.fx||void 0,s=((S=window.spwashi.values.fy)==null?void 0:S[t])||e.fy||void 0,a=((E=window.spwashi.values.r)==null?void 0:E[t])||e.r||window.spwashi.parameters.nodes.radiusMultiplier||void 0,u=((_=(M=window.spwashi.values.text)==null?void 0:M.fontSize)==null?void 0:_[t])||((A=e.text)==null?void 0:A.fontSize)||void 0;e.colorindex=ge(),e.fx=o,e.fy=s,e.r=a,e.collisionRadius=a*2,e.text=e.text||{},e.text.fontSize=u,e.image=e.image||{},e.image.r=100,e.image.offsetX=0,e.image.offsetY=0,ki(e);const c=It();e.url=Ot(e.md5,c,e.identity);const l=50,f=window.spwashi.parameters.width-50,d=window.spwashi.parameters.height-50,h=[50,50+d/4,50+d/2,50+3*d/4,d],m="conceptual.close",p="conceptual.open",w="essential.close",y="essential.open",x="structural.open",b="structural.close",g="locational.open",k="locational.close";return[[v=>Hr(v)==="container",{text:{fontSize:10},fx:window.spwashi.parameters.width/2,y:0}],[v=>B(v)==="nominal",{fx:void 0,r:30}],[v=>B(v)==="phrasal",{fx:void 0}],[v=>B(v)==="binding",{fx:100,r:5}],[v=>B(v)==="ordinal",{r:5}],[v=>B(v)===m&&ie(v),{r:10,fx:f,fy:h[0]}],[v=>B(v)===w&&ie(v),{r:10,fx:f,fy:h[1]}],[v=>B(v)===b&&ie(v),{r:10,fx:f,fy:h[2]}],[v=>B(v)===k&&ie(v),{r:10,fx:f,fy:h[3]}],[v=>B(v)===p&&ie(v),{r:10,fx:l,fy:h[0]}],[v=>B(v)===y&&ie(v),{r:10,fx:l,fy:h[1]}],[v=>B(v)===x&&ie(v),{r:10,fx:l,fy:h[2]}],[v=>B(v)===g&&ie(v),{r:10,fx:l,fy:h[3]}]].forEach(([v,I])=>{v(e)&&Object.entries(I).forEach(([W,j])=>{e[W]=j})}),e}const Te=e=>{window.spwashi.setItem("nodes",window.spwashi.nodes)},Xr=e=>{const n=(window.spwashi.getItem("nodes",window.spwashi.nodes)||[]).find(i=>i.id===e.id);return n||{}},rt=["var(--node-color-0)","var(--node-color-1)","var(--node-color-2)","var(--node-color-3)","var(--node-color-4)","var(--node-color-5)","var(--node-color-6)","var(--node-color-7)","var(--node-color-8)","var(--node-color-9)","var(--node-color-10)","var(--node-color-11)","var(--node-color-12)"],Ur=e=>rt[(e.colorindex||0)%rt.length],Dt=e=>e.name,_i=e=>rt[((e.colorindex||0)+5)%rt.length];class _n extends Map{constructor(t,n=Kr){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(bn(this,t))}has(t){return super.has(bn(this,t))}set(t,n){return super.set(Yr(this,t),n)}delete(t){return super.delete(jr(this,t))}}function bn({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function Yr({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function jr({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function Kr(e){return e!==null&&typeof e=="object"?e.valueOf():e}const Vr=Math.sqrt(50),Gr=Math.sqrt(10),Jr=Math.sqrt(2);function ot(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),o=i/Math.pow(10,r),s=o>=Vr?10:o>=Gr?5:o>=Jr?2:1;let a,u,c;return r<0?(c=Math.pow(10,-r)/s,a=Math.round(e*c),u=Math.round(t*c),a/c<e&&++a,u/c>t&&--u,c=-c):(c=Math.pow(10,r)*s,a=Math.round(e/c),u=Math.round(t/c),a*c<e&&++a,u*c>t&&--u),u<a&&.5<=n&&n<2?ot(e,t,n*2):[a,u,c]}function Wr(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[r,o,s]=i?ot(t,e,n):ot(e,t,n);if(!(o>=r))return[];const a=o-r+1,u=new Array(a);if(i)if(s<0)for(let c=0;c<a;++c)u[c]=(o-c)/-s;else for(let c=0;c<a;++c)u[c]=(o-c)*s;else if(s<0)for(let c=0;c<a;++c)u[c]=(r+c)/-s;else for(let c=0;c<a;++c)u[c]=(r+c)*s;return u}function $t(e,t,n){return t=+t,e=+e,n=+n,ot(e,t,n)[2]}function Qr(e,t,n){t=+t,e=+e,n=+n;const i=t<e,r=i?$t(t,e,n):$t(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}var Zr={value:()=>{}};function gt(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Qe(n)}function Qe(e){this._=e}function eo(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Qe.prototype=gt.prototype={constructor:Qe,on:function(e,t){var n=this._,i=eo(e+"",n),r,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(e=i[o]).type)&&(r=to(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(r=(e=i[o]).type)n[r]=Sn(n[r],e.name,t);else if(t==null)for(r in n)n[r]=Sn(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Qe(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],i=0,r=o.length;i<r;++i)o[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};function to(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function Sn(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=Zr,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var Rt="http://www.w3.org/1999/xhtml";const Nn={svg:"http://www.w3.org/2000/svg",xhtml:Rt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function mt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Nn.hasOwnProperty(t)?{space:Nn[t],local:e}:e}function no(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Rt&&t.documentElement.namespaceURI===Rt?t.createElement(e):t.createElementNS(n,e)}}function io(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function bi(e){var t=mt(e);return(t.local?io:no)(t)}function ro(){}function Vt(e){return e==null?ro:function(){return this.querySelector(e)}}function oo(e){typeof e!="function"&&(e=Vt(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o=t[r],s=o.length,a=i[r]=new Array(s),u,c,l=0;l<s;++l)(u=o[l])&&(c=e.call(u,u.__data__,l,o))&&("__data__"in u&&(c.__data__=u.__data__),a[l]=c);return new P(i,this._parents)}function so(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function ao(){return[]}function Si(e){return e==null?ao:function(){return this.querySelectorAll(e)}}function co(e){return function(){return so(e.apply(this,arguments))}}function lo(e){typeof e=="function"?e=co(e):e=Si(e);for(var t=this._groups,n=t.length,i=[],r=[],o=0;o<n;++o)for(var s=t[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&(i.push(e.call(u,u.__data__,c,s)),r.push(u));return new P(i,r)}function Ni(e){return function(){return this.matches(e)}}function Ci(e){return function(t){return t.matches(e)}}var uo=Array.prototype.find;function fo(e){return function(){return uo.call(this.children,e)}}function ho(){return this.firstElementChild}function po(e){return this.select(e==null?ho:fo(typeof e=="function"?e:Ci(e)))}var wo=Array.prototype.filter;function go(){return Array.from(this.children)}function mo(e){return function(){return wo.call(this.children,e)}}function yo(e){return this.selectAll(e==null?go:mo(typeof e=="function"?e:Ci(e)))}function xo(e){typeof e!="function"&&(e=Ni(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o=t[r],s=o.length,a=i[r]=[],u,c=0;c<s;++c)(u=o[c])&&e.call(u,u.__data__,c,o)&&a.push(u);return new P(i,this._parents)}function Mi(e){return new Array(e.length)}function vo(){return new P(this._enter||this._groups.map(Mi),this._parents)}function st(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}st.prototype={constructor:st,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ko(e){return function(){return e}}function _o(e,t,n,i,r,o){for(var s=0,a,u=t.length,c=o.length;s<c;++s)(a=t[s])?(a.__data__=o[s],i[s]=a):n[s]=new st(e,o[s]);for(;s<u;++s)(a=t[s])&&(r[s]=a)}function bo(e,t,n,i,r,o,s){var a,u,c=new Map,l=t.length,f=o.length,d=new Array(l),h;for(a=0;a<l;++a)(u=t[a])&&(d[a]=h=s.call(u,u.__data__,a,t)+"",c.has(h)?r[a]=u:c.set(h,u));for(a=0;a<f;++a)h=s.call(e,o[a],a,o)+"",(u=c.get(h))?(i[a]=u,u.__data__=o[a],c.delete(h)):n[a]=new st(e,o[a]);for(a=0;a<l;++a)(u=t[a])&&c.get(d[a])===u&&(r[a]=u)}function So(e){return e.__data__}function No(e,t){if(!arguments.length)return Array.from(this,So);var n=t?bo:_o,i=this._parents,r=this._groups;typeof e!="function"&&(e=ko(e));for(var o=r.length,s=new Array(o),a=new Array(o),u=new Array(o),c=0;c<o;++c){var l=i[c],f=r[c],d=f.length,h=Co(e.call(l,l&&l.__data__,c,i)),m=h.length,p=a[c]=new Array(m),w=s[c]=new Array(m),y=u[c]=new Array(d);n(l,f,p,w,y,h,t);for(var x=0,b=0,g,k;x<m;++x)if(g=p[x]){for(x>=b&&(b=x+1);!(k=w[b])&&++b<m;);g._next=k||null}}return s=new P(s,i),s._enter=a,s._exit=u,s}function Co(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Mo(){return new P(this._exit||this._groups.map(Mi),this._parents)}function Eo(e,t,n){var i=this.enter(),r=this,o=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?o.remove():n(o),i&&r?i.merge(r).order():r}function Ao(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,r=n.length,o=i.length,s=Math.min(r,o),a=new Array(r),u=0;u<s;++u)for(var c=n[u],l=i[u],f=c.length,d=a[u]=new Array(f),h,m=0;m<f;++m)(h=c[m]||l[m])&&(d[m]=h);for(;u<r;++u)a[u]=n[u];return new P(a,this._parents)}function To(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i=e[t],r=i.length-1,o=i[r],s;--r>=0;)(s=i[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Io(e){e||(e=Oo);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s=n[o],a=s.length,u=r[o]=new Array(a),c,l=0;l<a;++l)(c=s[l])&&(u[l]=c);u.sort(t)}return new P(r,this._parents).order()}function Oo(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Do(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function $o(){return Array.from(this)}function Ro(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null}function Lo(){let e=0;for(const t of this)++e;return e}function zo(){return!this.node()}function Po(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var r=t[n],o=0,s=r.length,a;o<s;++o)(a=r[o])&&e.call(a,a.__data__,o,r);return this}function Fo(e){return function(){this.removeAttribute(e)}}function Bo(e){return function(){this.removeAttributeNS(e.space,e.local)}}function qo(e,t){return function(){this.setAttribute(e,t)}}function Ho(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Xo(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Uo(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Yo(e,t){var n=mt(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((t==null?n.local?Bo:Fo:typeof t=="function"?n.local?Uo:Xo:n.local?Ho:qo)(n,t))}function Ei(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function jo(e){return function(){this.style.removeProperty(e)}}function Ko(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Vo(e,t,n){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function Go(e,t,n){return arguments.length>1?this.each((t==null?jo:typeof t=="function"?Vo:Ko)(e,t,n??"")):_e(this.node(),e)}function _e(e,t){return e.style.getPropertyValue(t)||Ei(e).getComputedStyle(e,null).getPropertyValue(t)}function Jo(e){return function(){delete this[e]}}function Wo(e,t){return function(){this[e]=t}}function Qo(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Zo(e,t){return arguments.length>1?this.each((t==null?Jo:typeof t=="function"?Qo:Wo)(e,t)):this.node()[e]}function Ai(e){return e.trim().split(/^|\s+/)}function Gt(e){return e.classList||new Ti(e)}function Ti(e){this._node=e,this._names=Ai(e.getAttribute("class")||"")}Ti.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ii(e,t){for(var n=Gt(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function Oi(e,t){for(var n=Gt(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function es(e){return function(){Ii(this,e)}}function ts(e){return function(){Oi(this,e)}}function ns(e,t){return function(){(t.apply(this,arguments)?Ii:Oi)(this,e)}}function is(e,t){var n=Ai(e+"");if(arguments.length<2){for(var i=Gt(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?ns:t?es:ts)(n,t))}function rs(){this.textContent=""}function os(e){return function(){this.textContent=e}}function ss(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function as(e){return arguments.length?this.each(e==null?rs:(typeof e=="function"?ss:os)(e)):this.node().textContent}function cs(){this.innerHTML=""}function ls(e){return function(){this.innerHTML=e}}function us(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function fs(e){return arguments.length?this.each(e==null?cs:(typeof e=="function"?us:ls)(e)):this.node().innerHTML}function ds(){this.nextSibling&&this.parentNode.appendChild(this)}function hs(){return this.each(ds)}function ps(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ws(){return this.each(ps)}function gs(e){var t=typeof e=="function"?e:bi(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function ms(){return null}function ys(e,t){var n=typeof e=="function"?e:bi(e),i=t==null?ms:typeof t=="function"?t:Vt(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function xs(){var e=this.parentNode;e&&e.removeChild(this)}function vs(){return this.each(xs)}function ks(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function _s(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function bs(e){return this.select(e?_s:ks)}function Ss(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Ns(e){return function(t){e.call(this,t,this.__data__)}}function Cs(e){return e.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");return i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),{type:t,name:n}})}function Ms(e){return function(){var t=this.__on;if(t){for(var n=0,i=-1,r=t.length,o;n<r;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++i]=o;++i?t.length=i:delete this.__on}}}function Es(e,t,n){return function(){var i=this.__on,r,o=Ns(t);if(i){for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=t;return}}this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function As(e,t,n){var i=Cs(e+""),r,o=i.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,c=a.length,l;u<c;++u)for(r=0,l=a[u];r<o;++r)if((s=i[r]).type===l.type&&s.name===l.name)return l.value}return}for(a=t?Es:Ms,r=0;r<o;++r)this.each(a(i[r],t,n));return this}function Di(e,t,n){var i=Ei(e),r=i.CustomEvent;typeof r=="function"?r=new r(t,n):(r=i.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Ts(e,t){return function(){return Di(this,e,t)}}function Is(e,t){return function(){return Di(this,e,t.apply(this,arguments))}}function Os(e,t){return this.each((typeof t=="function"?Is:Ts)(e,t))}function*Ds(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length,s;r<o;++r)(s=i[r])&&(yield s)}var $i=[null];function P(e,t){this._groups=e,this._parents=t}function Be(){return new P([[document.documentElement]],$i)}function $s(){return this}P.prototype=Be.prototype={constructor:P,select:oo,selectAll:lo,selectChild:po,selectChildren:yo,filter:xo,data:No,enter:vo,exit:Mo,join:Eo,merge:Ao,selection:$s,order:To,sort:Io,call:Do,nodes:$o,node:Ro,size:Lo,empty:zo,each:Po,attr:Yo,style:Go,property:Zo,classed:is,text:as,html:fs,raise:hs,lower:ws,append:gs,insert:ys,remove:vs,clone:bs,datum:Ss,on:As,dispatch:Os,[Symbol.iterator]:Ds};function Ie(e){return typeof e=="string"?new P([[document.querySelector(e)]],[document.documentElement]):new P([[e]],$i)}function Rs(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Cn(e,t){if(e=Rs(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ls={passive:!1},Oe={capture:!0,passive:!1};function St(e){e.stopImmediatePropagation()}function ve(e){e.preventDefault(),e.stopImmediatePropagation()}function zs(e){var t=e.document.documentElement,n=Ie(e).on("dragstart.drag",ve,Oe);"onselectstart"in t?n.on("selectstart.drag",ve,Oe):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Ps(e,t){var n=e.document.documentElement,i=Ie(e).on("dragstart.drag",null);t&&(i.on("click.drag",ve,Oe),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ue=e=>()=>e;function Lt(e,{sourceEvent:t,subject:n,target:i,identifier:r,active:o,x:s,y:a,dx:u,dy:c,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:l}})}Lt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Fs(e){return!e.ctrlKey&&!e.button}function Bs(){return this.parentNode}function qs(e,t){return t??{x:e.x,y:e.y}}function Hs(){return navigator.maxTouchPoints||"ontouchstart"in this}function Jt(){var e=Fs,t=Bs,n=qs,i=Hs,r={},o=gt("start","drag","end"),s=0,a,u,c,l,f=0;function d(g){g.on("mousedown.drag",h).filter(i).on("touchstart.drag",w).on("touchmove.drag",y,Ls).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(g,k){if(!(l||!e.call(this,g,k))){var N=b(this,t.call(this,g,k),g,k,"mouse");N&&(Ie(g.view).on("mousemove.drag",m,Oe).on("mouseup.drag",p,Oe),zs(g.view),St(g),c=!1,a=g.clientX,u=g.clientY,N("start",g))}}function m(g){if(ve(g),!c){var k=g.clientX-a,N=g.clientY-u;c=k*k+N*N>f}r.mouse("drag",g)}function p(g){Ie(g.view).on("mousemove.drag mouseup.drag",null),Ps(g.view,c),ve(g),r.mouse("end",g)}function w(g,k){if(e.call(this,g,k)){var N=g.changedTouches,C=t.call(this,g,k),S=N.length,E,M;for(E=0;E<S;++E)(M=b(this,C,g,k,N[E].identifier,N[E]))&&(St(g),M("start",g,N[E]))}}function y(g){var k=g.changedTouches,N=k.length,C,S;for(C=0;C<N;++C)(S=r[k[C].identifier])&&(ve(g),S("drag",g,k[C]))}function x(g){var k=g.changedTouches,N=k.length,C,S;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),C=0;C<N;++C)(S=r[k[C].identifier])&&(St(g),S("end",g,k[C]))}function b(g,k,N,C,S,E){var M=o.copy(),_=Cn(E||N,k),A,v,I;if((I=n.call(g,new Lt("beforestart",{sourceEvent:N,target:d,identifier:S,active:s,x:_[0],y:_[1],dx:0,dy:0,dispatch:M}),C))!=null)return A=I.x-_[0]||0,v=I.y-_[1]||0,function W(j,ce,xe){var F=_,_t;switch(j){case"start":r[S]=W,_t=s++;break;case"end":delete r[S],--s;case"drag":_=Cn(xe||ce,k),_t=s;break}M.call(j,g,new Lt(j,{sourceEvent:ce,subject:I,target:d,identifier:S,active:_t,x:_[0]+A,y:_[1]+v,dx:_[0]-F[0],dy:_[1]-F[1],dispatch:M}),C)}}return d.filter=function(g){return arguments.length?(e=typeof g=="function"?g:Ue(!!g),d):e},d.container=function(g){return arguments.length?(t=typeof g=="function"?g:Ue(g),d):t},d.subject=function(g){return arguments.length?(n=typeof g=="function"?g:Ue(g),d):n},d.touchable=function(g){return arguments.length?(i=typeof g=="function"?g:Ue(!!g),d):i},d.on=function(){var g=o.on.apply(o,arguments);return g===o?d:g},d.clickDistance=function(g){return arguments.length?(f=(g=+g)*g,d):Math.sqrt(f)},d}function Wt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ri(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function qe(){}var De=.7,at=1/De,ke="\\s*([+-]?\\d+)\\s*",$e="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",G="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xs=/^#([0-9a-f]{3,8})$/,Us=new RegExp(`^rgb\\(${ke},${ke},${ke}\\)$`),Ys=new RegExp(`^rgb\\(${G},${G},${G}\\)$`),js=new RegExp(`^rgba\\(${ke},${ke},${ke},${$e}\\)$`),Ks=new RegExp(`^rgba\\(${G},${G},${G},${$e}\\)$`),Vs=new RegExp(`^hsl\\(${$e},${G},${G}\\)$`),Gs=new RegExp(`^hsla\\(${$e},${G},${G},${$e}\\)$`),Mn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wt(qe,he,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:En,formatHex:En,formatHex8:Js,formatHsl:Ws,formatRgb:An,toString:An});function En(){return this.rgb().formatHex()}function Js(){return this.rgb().formatHex8()}function Ws(){return Li(this).formatHsl()}function An(){return this.rgb().formatRgb()}function he(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Xs.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Tn(t):n===3?new R(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ye(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ye(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Us.exec(e))?new R(t[1],t[2],t[3],1):(t=Ys.exec(e))?new R(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=js.exec(e))?Ye(t[1],t[2],t[3],t[4]):(t=Ks.exec(e))?Ye(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Vs.exec(e))?Dn(t[1],t[2]/100,t[3]/100,1):(t=Gs.exec(e))?Dn(t[1],t[2]/100,t[3]/100,t[4]):Mn.hasOwnProperty(e)?Tn(Mn[e]):e==="transparent"?new R(NaN,NaN,NaN,0):null}function Tn(e){return new R(e>>16&255,e>>8&255,e&255,1)}function Ye(e,t,n,i){return i<=0&&(e=t=n=NaN),new R(e,t,n,i)}function Qs(e){return e instanceof qe||(e=he(e)),e?(e=e.rgb(),new R(e.r,e.g,e.b,e.opacity)):new R}function zt(e,t,n,i){return arguments.length===1?Qs(e):new R(e,t,n,i??1)}function R(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Wt(R,zt,Ri(qe,{brighter(e){return e=e==null?at:Math.pow(at,e),new R(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?De:Math.pow(De,e),new R(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new R(ue(this.r),ue(this.g),ue(this.b),ct(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:In,formatHex:In,formatHex8:Zs,formatRgb:On,toString:On}));function In(){return`#${le(this.r)}${le(this.g)}${le(this.b)}`}function Zs(){return`#${le(this.r)}${le(this.g)}${le(this.b)}${le((isNaN(this.opacity)?1:this.opacity)*255)}`}function On(){const e=ct(this.opacity);return`${e===1?"rgb(":"rgba("}${ue(this.r)}, ${ue(this.g)}, ${ue(this.b)}${e===1?")":`, ${e})`}`}function ct(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ue(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function le(e){return e=ue(e),(e<16?"0":"")+e.toString(16)}function Dn(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new X(e,t,n,i)}function Li(e){if(e instanceof X)return new X(e.h,e.s,e.l,e.opacity);if(e instanceof qe||(e=he(e)),!e)return new X;if(e instanceof X)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,a=o-r,u=(o+r)/2;return a?(t===o?s=(n-i)/a+(n<i)*6:n===o?s=(i-t)/a+2:s=(t-n)/a+4,a/=u<.5?o+r:2-o-r,s*=60):a=u>0&&u<1?0:s,new X(s,a,u,e.opacity)}function ea(e,t,n,i){return arguments.length===1?Li(e):new X(e,t,n,i??1)}function X(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Wt(X,ea,Ri(qe,{brighter(e){return e=e==null?at:Math.pow(at,e),new X(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?De:Math.pow(De,e),new X(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new R(Nt(e>=240?e-240:e+120,r,i),Nt(e,r,i),Nt(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new X($n(this.h),je(this.s),je(this.l),ct(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ct(this.opacity);return`${e===1?"hsl(":"hsla("}${$n(this.h)}, ${je(this.s)*100}%, ${je(this.l)*100}%${e===1?")":`, ${e})`}`}}));function $n(e){return e=(e||0)%360,e<0?e+360:e}function je(e){return Math.max(0,Math.min(1,e||0))}function Nt(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Qt=e=>()=>e;function ta(e,t){return function(n){return e+n*t}}function na(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function ia(e){return(e=+e)==1?zi:function(t,n){return n-t?na(t,n,e):Qt(isNaN(t)?n:t)}}function zi(e,t){var n=t-e;return n?ta(e,n):Qt(isNaN(e)?t:e)}const lt=function e(t){var n=ia(t);function i(r,o){var s=n((r=zt(r)).r,(o=zt(o)).r),a=n(r.g,o.g),u=n(r.b,o.b),c=zi(r.opacity,o.opacity);return function(l){return r.r=s(l),r.g=a(l),r.b=u(l),r.opacity=c(l),r+""}}return i.gamma=e,i}(1);function ra(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=e[r]*(1-o)+t[r]*o;return i}}function oa(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function sa(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),o=new Array(n),s;for(s=0;s<i;++s)r[s]=Zt(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<i;++s)o[s]=r[s](a);return o}}function aa(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function V(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function ca(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Zt(e[r],t[r]):i[r]=t[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var Pt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ct=new RegExp(Pt.source,"g");function la(e){return function(){return e}}function ua(e){return function(t){return e(t)+""}}function Pi(e,t){var n=Pt.lastIndex=Ct.lastIndex=0,i,r,o,s=-1,a=[],u=[];for(e=e+"",t=t+"";(i=Pt.exec(e))&&(r=Ct.exec(t));)(o=r.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(i=i[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:V(i,r)})),n=Ct.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?ua(u[0].x):la(t):(t=u.length,function(c){for(var l=0,f;l<t;++l)a[(f=u[l]).i]=f.x(c);return a.join("")})}function Zt(e,t){var n=typeof t,i;return t==null||n==="boolean"?Qt(t):(n==="number"?V:n==="string"?(i=he(t))?(t=i,lt):Pi:t instanceof he?lt:t instanceof Date?aa:oa(t)?ra:Array.isArray(t)?sa:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?ca:V)(e,t)}function fa(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Rn=180/Math.PI,Ft={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Fi(e,t,n,i,r,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),e*i<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*Rn,skewX:Math.atan(u)*Rn,scaleX:s,scaleY:a}}var Ke;function da(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ft:Fi(t.a,t.b,t.c,t.d,t.e,t.f)}function ha(e){return e==null||(Ke||(Ke=document.createElementNS("http://www.w3.org/2000/svg","g")),Ke.setAttribute("transform",e),!(e=Ke.transform.baseVal.consolidate()))?Ft:(e=e.matrix,Fi(e.a,e.b,e.c,e.d,e.e,e.f))}function Bi(e,t,n,i){function r(c){return c.length?c.pop()+" ":""}function o(c,l,f,d,h,m){if(c!==f||l!==d){var p=h.push("translate(",null,t,null,n);m.push({i:p-4,x:V(c,f)},{i:p-2,x:V(l,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function s(c,l,f,d){c!==l?(c-l>180?l+=360:l-c>180&&(c+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:V(c,l)})):l&&f.push(r(f)+"rotate("+l+i)}function a(c,l,f,d){c!==l?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:V(c,l)}):l&&f.push(r(f)+"skewX("+l+i)}function u(c,l,f,d,h,m){if(c!==f||l!==d){var p=h.push(r(h)+"scale(",null,",",null,")");m.push({i:p-4,x:V(c,f)},{i:p-2,x:V(l,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(c,l){var f=[],d=[];return c=e(c),l=e(l),o(c.translateX,c.translateY,l.translateX,l.translateY,f,d),s(c.rotate,l.rotate,f,d),a(c.skewX,l.skewX,f,d),u(c.scaleX,c.scaleY,l.scaleX,l.scaleY,f,d),c=l=null,function(h){for(var m=-1,p=d.length,w;++m<p;)f[(w=d[m]).i]=w.x(h);return f.join("")}}}var pa=Bi(da,"px, ","px)","deg)"),wa=Bi(ha,", ",")",")"),be=0,Ce=0,Ne=0,qi=1e3,ut,Me,ft=0,pe=0,yt=0,Re=typeof performance=="object"&&performance.now?performance:Date,Hi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function en(){return pe||(Hi(ga),pe=Re.now()+yt)}function ga(){pe=0}function dt(){this._call=this._time=this._next=null}dt.prototype=tn.prototype={constructor:dt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?en():+n)+(t==null?0:+t),!this._next&&Me!==this&&(Me?Me._next=this:ut=this,Me=this),this._call=e,this._time=n,Bt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Bt())}};function tn(e,t,n){var i=new dt;return i.restart(e,t,n),i}function ma(){en(),++be;for(var e=ut,t;e;)(t=pe-e._time)>=0&&e._call.call(void 0,t),e=e._next;--be}function Ln(){pe=(ft=Re.now())+yt,be=Ce=0;try{ma()}finally{be=0,xa(),pe=0}}function ya(){var e=Re.now(),t=e-ft;t>qi&&(yt-=t,ft=e)}function xa(){for(var e,t=ut,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:ut=n);Me=e,Bt(i)}function Bt(e){if(!be){Ce&&(Ce=clearTimeout(Ce));var t=e-pe;t>24?(e<1/0&&(Ce=setTimeout(Ln,e-Re.now()-yt)),Ne&&(Ne=clearInterval(Ne))):(Ne||(ft=Re.now(),Ne=setInterval(ya,qi)),be=1,Hi(Ln))}}function zn(e,t,n){var i=new dt;return t=t==null?0:+t,i.restart(r=>{i.stop(),e(r+t)},t,n),i}var va=gt("start","end","cancel","interrupt"),ka=[],Xi=0,Pn=1,qt=2,Ze=3,Fn=4,Ht=5,et=6;function xt(e,t,n,i,r,o){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;_a(e,n,{name:t,index:i,group:r,on:va,tween:ka,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Xi})}function nn(e,t){var n=Y(e,t);if(n.state>Xi)throw new Error("too late; already scheduled");return n}function J(e,t){var n=Y(e,t);if(n.state>Ze)throw new Error("too late; already running");return n}function Y(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function _a(e,t,n){var i=e.__transition,r;i[t]=n,n.timer=tn(o,0,n.time);function o(c){n.state=Pn,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var l,f,d,h;if(n.state!==Pn)return u();for(l in i)if(h=i[l],h.name===n.name){if(h.state===Ze)return zn(s);h.state===Fn?(h.state=et,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete i[l]):+l<t&&(h.state=et,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete i[l])}if(zn(function(){n.state===Ze&&(n.state=Fn,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=qt,n.on.call("start",e,e.__data__,n.index,n.group),n.state===qt){for(n.state=Ze,r=new Array(d=n.tween.length),l=0,f=-1;l<d;++l)(h=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(r[++f]=h);r.length=f+1}}function a(c){for(var l=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=Ht,1),f=-1,d=r.length;++f<d;)r[f].call(e,l);n.state===Ht&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=et,n.timer.stop(),delete i[t];for(var c in i)return;delete e.__transition}}function ba(e,t){var n=e.__transition,i,r,o=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((i=n[s]).name!==t){o=!1;continue}r=i.state>qt&&i.state<Ht,i.state=et,i.timer.stop(),i.on.call(r?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete n[s]}o&&delete e.__transition}}function Sa(e){return this.each(function(){ba(this,e)})}function Na(e,t){var n,i;return function(){var r=J(this,e),o=r.tween;if(o!==n){i=n=o;for(var s=0,a=i.length;s<a;++s)if(i[s].name===t){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function Ca(e,t,n){var i,r;if(typeof n!="function")throw new Error;return function(){var o=J(this,e),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:t,value:n},u=0,c=r.length;u<c;++u)if(r[u].name===t){r[u]=a;break}u===c&&r.push(a)}o.tween=r}}function Ma(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i=Y(this.node(),n).tween,r=0,o=i.length,s;r<o;++r)if((s=i[r]).name===e)return s.value;return null}return this.each((t==null?Na:Ca)(n,e,t))}function rn(e,t,n){var i=e._id;return e.each(function(){var r=J(this,i);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return Y(r,i).value[t]}}function Ui(e,t){var n;return(typeof t=="number"?V:t instanceof he?lt:(n=he(t))?(t=n,lt):Pi)(e,t)}function Ea(e){return function(){this.removeAttribute(e)}}function Aa(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ta(e,t,n){var i,r=n+"",o;return function(){var s=this.getAttribute(e);return s===r?null:s===i?o:o=t(i=s,n)}}function Ia(e,t,n){var i,r=n+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===i?o:o=t(i=s,n)}}function Oa(e,t,n){var i,r,o;return function(){var s,a=n(this),u;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),u=a+"",s===u?null:s===i&&u===r?o:(r=u,o=t(i=s,a)))}}function Da(e,t,n){var i,r,o;return function(){var s,a=n(this),u;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),u=a+"",s===u?null:s===i&&u===r?o:(r=u,o=t(i=s,a)))}}function $a(e,t){var n=mt(e),i=n==="transform"?wa:Ui;return this.attrTween(e,typeof t=="function"?(n.local?Da:Oa)(n,i,rn(this,"attr."+e,t)):t==null?(n.local?Aa:Ea)(n):(n.local?Ia:Ta)(n,i,t))}function Ra(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function La(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function za(e,t){var n,i;function r(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&La(e,o)),n}return r._value=t,r}function Pa(e,t){var n,i;function r(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&Ra(e,o)),n}return r._value=t,r}function Fa(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var i=mt(e);return this.tween(n,(i.local?za:Pa)(i,t))}function Ba(e,t){return function(){nn(this,e).delay=+t.apply(this,arguments)}}function qa(e,t){return t=+t,function(){nn(this,e).delay=t}}function Ha(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ba:qa)(t,e)):Y(this.node(),t).delay}function Xa(e,t){return function(){J(this,e).duration=+t.apply(this,arguments)}}function Ua(e,t){return t=+t,function(){J(this,e).duration=t}}function Ya(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Xa:Ua)(t,e)):Y(this.node(),t).duration}function ja(e,t){if(typeof t!="function")throw new Error;return function(){J(this,e).ease=t}}function Ka(e){var t=this._id;return arguments.length?this.each(ja(t,e)):Y(this.node(),t).ease}function Va(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;J(this,e).ease=n}}function Ga(e){if(typeof e!="function")throw new Error;return this.each(Va(this._id,e))}function Ja(e){typeof e!="function"&&(e=Ni(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o=t[r],s=o.length,a=i[r]=[],u,c=0;c<s;++c)(u=o[c])&&e.call(u,u.__data__,c,o)&&a.push(u);return new te(i,this._parents,this._name,this._id)}function Wa(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,i=t.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var u=t[a],c=n[a],l=u.length,f=s[a]=new Array(l),d,h=0;h<l;++h)(d=u[h]||c[h])&&(f[h]=d);for(;a<i;++a)s[a]=t[a];return new te(s,this._parents,this._name,this._id)}function Qa(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Za(e,t,n){var i,r,o=Qa(t)?nn:J;return function(){var s=o(this,e),a=s.on;a!==i&&(r=(i=a).copy()).on(t,n),s.on=r}}function ec(e,t){var n=this._id;return arguments.length<2?Y(this.node(),n).on.on(e):this.each(Za(n,e,t))}function tc(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function nc(){return this.on("end.remove",tc(this._id))}function ic(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Vt(e));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a=i[s],u=a.length,c=o[s]=new Array(u),l,f,d=0;d<u;++d)(l=a[d])&&(f=e.call(l,l.__data__,d,a))&&("__data__"in l&&(f.__data__=l.__data__),c[d]=f,xt(c[d],t,n,d,c,Y(l,n)));return new te(o,this._parents,t,n)}function rc(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Si(e));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var u=i[a],c=u.length,l,f=0;f<c;++f)if(l=u[f]){for(var d=e.call(l,l.__data__,f,u),h,m=Y(l,n),p=0,w=d.length;p<w;++p)(h=d[p])&&xt(h,t,n,p,d,m);o.push(d),s.push(l)}return new te(o,s,t,n)}var oc=Be.prototype.constructor;function sc(){return new oc(this._groups,this._parents)}function ac(e,t){var n,i,r;return function(){var o=_e(this,e),s=(this.style.removeProperty(e),_e(this,e));return o===s?null:o===n&&s===i?r:r=t(n=o,i=s)}}function Yi(e){return function(){this.style.removeProperty(e)}}function cc(e,t,n){var i,r=n+"",o;return function(){var s=_e(this,e);return s===r?null:s===i?o:o=t(i=s,n)}}function lc(e,t,n){var i,r,o;return function(){var s=_e(this,e),a=n(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(e),_e(this,e))),s===u?null:s===i&&u===r?o:(r=u,o=t(i=s,a))}}function uc(e,t){var n,i,r,o="style."+t,s="end."+o,a;return function(){var u=J(this,e),c=u.on,l=u.value[o]==null?a||(a=Yi(t)):void 0;(c!==n||r!==l)&&(i=(n=c).copy()).on(s,r=l),u.on=i}}function fc(e,t,n){var i=(e+="")=="transform"?pa:Ui;return t==null?this.styleTween(e,ac(e,i)).on("end.style."+e,Yi(e)):typeof t=="function"?this.styleTween(e,lc(e,i,rn(this,"style."+e,t))).each(uc(this._id,e)):this.styleTween(e,cc(e,i,t),n).on("end.style."+e,null)}function dc(e,t,n){return function(i){this.style.setProperty(e,t.call(this,i),n)}}function hc(e,t,n){var i,r;function o(){var s=t.apply(this,arguments);return s!==r&&(i=(r=s)&&dc(e,s,n)),i}return o._value=t,o}function pc(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,hc(e,t,n??""))}function wc(e){return function(){this.textContent=e}}function gc(e){return function(){var t=e(this);this.textContent=t??""}}function mc(e){return this.tween("text",typeof e=="function"?gc(rn(this,"text",e)):wc(e==null?"":e+""))}function yc(e){return function(t){this.textContent=e.call(this,t)}}function xc(e){var t,n;function i(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&yc(r)),t}return i._value=e,i}function vc(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,xc(e))}function kc(){for(var e=this._name,t=this._id,n=ji(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,u,c=0;c<a;++c)if(u=s[c]){var l=Y(u,t);xt(u,e,n,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new te(i,this._parents,e,n)}function _c(){var e,t,n=this,i=n._id,r=n.size();return new Promise(function(o,s){var a={value:s},u={value:function(){--r===0&&o()}};n.each(function(){var c=J(this,i),l=c.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(u)),c.on=t}),r===0&&o()})}var bc=0;function te(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function ji(){return++bc}var Q=Be.prototype;te.prototype={constructor:te,select:ic,selectAll:rc,selectChild:Q.selectChild,selectChildren:Q.selectChildren,filter:Ja,merge:Wa,selection:sc,transition:kc,call:Q.call,nodes:Q.nodes,node:Q.node,size:Q.size,empty:Q.empty,each:Q.each,on:ec,attr:$a,attrTween:Fa,style:fc,styleTween:pc,text:mc,textTween:vc,remove:nc,tween:Ma,delay:Ha,duration:Ya,ease:Ka,easeVarying:Ga,end:_c,[Symbol.iterator]:Q[Symbol.iterator]};function Sc(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Nc={time:null,delay:0,duration:250,ease:Sc};function Cc(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Mc(e){var t,n;e instanceof te?(t=e._id,e=e._name):(t=ji(),(n=Nc).time=en(),e=e==null?null:e+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&xt(u,e,t,c,s,n||Cc(u,t));return new te(i,this._parents,e,t)}Be.prototype.interrupt=Sa;Be.prototype.transition=Mc;function Ec(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var o,s=n.length,a,u=0,c=0;for(o=0;o<s;++o)a=n[o],u+=a.x,c+=a.y;for(u=(u/s-e)*i,c=(c/s-t)*i,o=0;o<s;++o)a=n[o],a.x-=u,a.y-=c}return r.initialize=function(o){n=o},r.x=function(o){return arguments.length?(e=+o,r):e},r.y=function(o){return arguments.length?(t=+o,r):t},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function Ac(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Ki(this.cover(t,n),t,n,e)}function Ki(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,o=e._root,s={data:i},a=e._x0,u=e._y0,c=e._x1,l=e._y1,f,d,h,m,p,w,y,x;if(!o)return e._root=s,e;for(;o.length;)if((p=t>=(f=(a+c)/2))?a=f:c=f,(w=n>=(d=(u+l)/2))?u=d:l=d,r=o,!(o=o[y=w<<1|p]))return r[y]=s,e;if(h=+e._x.call(null,o.data),m=+e._y.call(null,o.data),t===h&&n===m)return s.next=o,r?r[y]=s:e._root=s,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(p=t>=(f=(a+c)/2))?a=f:c=f,(w=n>=(d=(u+l)/2))?u=d:l=d;while((y=w<<1|p)===(x=(m>=d)<<1|h>=f));return r[x]=o,r[y]=s,e}function Tc(e){var t,n,i=e.length,r,o,s=new Array(i),a=new Array(i),u=1/0,c=1/0,l=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=r,a[n]=o,r<u&&(u=r),r>l&&(l=r),o<c&&(c=o),o>f&&(f=o));if(u>l||c>f)return this;for(this.cover(u,c).cover(l,f),n=0;n<i;++n)Ki(this,s[n],a[n],e[n]);return this}function Ic(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1;else{for(var s=r-n||1,a=this._root,u,c;n>e||e>=r||i>t||t>=o;)switch(c=(t<i)<<1|e<n,u=new Array(4),u[c]=a,a=u,s*=2,c){case 0:r=n+s,o=i+s;break;case 1:n=r-s,o=i+s;break;case 2:r=n+s,i=o-s;break;case 3:n=r-s,i=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this}function Oc(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Dc(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function O(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function $c(e,t,n){var i,r=this._x0,o=this._y0,s,a,u,c,l=this._x1,f=this._y1,d=[],h=this._root,m,p;for(h&&d.push(new O(h,r,o,l,f)),n==null?n=1/0:(r=e-n,o=t-n,l=e+n,f=t+n,n*=n);m=d.pop();)if(!(!(h=m.node)||(s=m.x0)>l||(a=m.y0)>f||(u=m.x1)<r||(c=m.y1)<o))if(h.length){var w=(s+u)/2,y=(a+c)/2;d.push(new O(h[3],w,y,u,c),new O(h[2],s,y,w,c),new O(h[1],w,a,u,y),new O(h[0],s,a,w,y)),(p=(t>=y)<<1|e>=w)&&(m=d[d.length-1],d[d.length-1]=d[d.length-1-p],d[d.length-1-p]=m)}else{var x=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),g=x*x+b*b;if(g<n){var k=Math.sqrt(n=g);r=e-k,o=t-k,l=e+k,f=t+k,i=h.data}}return i}function Rc(e){if(isNaN(l=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,o,s=this._x0,a=this._y0,u=this._x1,c=this._y1,l,f,d,h,m,p,w,y;if(!n)return this;if(n.length)for(;;){if((m=l>=(d=(s+u)/2))?s=d:u=d,(p=f>=(h=(a+c)/2))?a=h:c=h,t=n,!(n=n[w=p<<1|m]))return this;if(!n.length)break;(t[w+1&3]||t[w+2&3]||t[w+3&3])&&(i=t,y=w)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,r?(o?r.next=o:delete r.next,this):t?(o?t[w]=o:delete t[w],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=o,this)}function Lc(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function zc(){return this._root}function Pc(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Fc(e){var t=[],n,i=this._root,r,o,s,a,u;for(i&&t.push(new O(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&i.length){var c=(o+a)/2,l=(s+u)/2;(r=i[3])&&t.push(new O(r,c,l,a,u)),(r=i[2])&&t.push(new O(r,o,l,c,u)),(r=i[1])&&t.push(new O(r,c,s,a,l)),(r=i[0])&&t.push(new O(r,o,s,c,l))}return this}function Bc(e){var t=[],n=[],i;for(this._root&&t.push(new O(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var o,s=i.x0,a=i.y0,u=i.x1,c=i.y1,l=(s+u)/2,f=(a+c)/2;(o=r[0])&&t.push(new O(o,s,a,l,f)),(o=r[1])&&t.push(new O(o,l,a,u,f)),(o=r[2])&&t.push(new O(o,s,f,l,c)),(o=r[3])&&t.push(new O(o,l,f,u,c))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function qc(e){return e[0]}function Hc(e){return arguments.length?(this._x=e,this):this._x}function Xc(e){return e[1]}function Uc(e){return arguments.length?(this._y=e,this):this._y}function on(e,t,n){var i=new sn(t??qc,n??Xc,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function sn(e,t,n,i,r,o){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function Bn(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var $=on.prototype=sn.prototype;$.copy=function(){var e=new sn(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=Bn(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=Bn(i));return e};$.add=Ac;$.addAll=Tc;$.cover=Ic;$.data=Oc;$.extent=Dc;$.find=$c;$.remove=Rc;$.removeAll=Lc;$.root=zc;$.size=Pc;$.visit=Fc;$.visitAfter=Bc;$.x=Hc;$.y=Uc;function fe(e){return function(){return e}}function oe(e){return(e()-.5)*1e-6}function Yc(e){return e.x+e.vx}function jc(e){return e.y+e.vy}function Kc(e){var t,n,i,r=1,o=1;typeof e!="function"&&(e=fe(e==null?1:+e));function s(){for(var c,l=t.length,f,d,h,m,p,w,y=0;y<o;++y)for(f=on(t,Yc,jc).visitAfter(a),c=0;c<l;++c)d=t[c],p=n[d.index],w=p*p,h=d.x+d.vx,m=d.y+d.vy,f.visit(x);function x(b,g,k,N,C){var S=b.data,E=b.r,M=p+E;if(S){if(S.index>d.index){var _=h-S.x-S.vx,A=m-S.y-S.vy,v=_*_+A*A;v<M*M&&(_===0&&(_=oe(i),v+=_*_),A===0&&(A=oe(i),v+=A*A),v=(M-(v=Math.sqrt(v)))/v*r,d.vx+=(_*=v)*(M=(E*=E)/(w+E)),d.vy+=(A*=v)*M,S.vx-=_*(M=1-M),S.vy-=A*M)}return}return g>h+M||N<h-M||k>m+M||C<m-M}}function a(c){if(c.data)return c.r=n[c.data.index];for(var l=c.r=0;l<4;++l)c[l]&&c[l].r>c.r&&(c.r=c[l].r)}function u(){if(t){var c,l=t.length,f;for(n=new Array(l),c=0;c<l;++c)f=t[c],n[f.index]=+e(f,c,t)}}return s.initialize=function(c,l){t=c,i=l,u()},s.iterations=function(c){return arguments.length?(o=+c,s):o},s.strength=function(c){return arguments.length?(r=+c,s):r},s.radius=function(c){return arguments.length?(e=typeof c=="function"?c:fe(+c),u(),s):e},s}function Vc(e){return e.index}function qn(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Gc(e){var t=Vc,n=f,i,r=fe(30),o,s,a,u,c,l=1;e==null&&(e=[]);function f(w){return 1/Math.min(a[w.source.index],a[w.target.index])}function d(w){for(var y=0,x=e.length;y<l;++y)for(var b=0,g,k,N,C,S,E,M;b<x;++b)g=e[b],k=g.source,N=g.target,C=N.x+N.vx-k.x-k.vx||oe(c),S=N.y+N.vy-k.y-k.vy||oe(c),E=Math.sqrt(C*C+S*S),E=(E-o[b])/E*w*i[b],C*=E,S*=E,N.vx-=C*(M=u[b]),N.vy-=S*M,k.vx+=C*(M=1-M),k.vy+=S*M}function h(){if(s){var w,y=s.length,x=e.length,b=new Map(s.map((k,N)=>[t(k,N,s),k])),g;for(w=0,a=new Array(y);w<x;++w)g=e[w],g.index=w,typeof g.source!="object"&&(g.source=qn(b,g.source)),typeof g.target!="object"&&(g.target=qn(b,g.target)),a[g.source.index]=(a[g.source.index]||0)+1,a[g.target.index]=(a[g.target.index]||0)+1;for(w=0,u=new Array(x);w<x;++w)g=e[w],u[w]=a[g.source.index]/(a[g.source.index]+a[g.target.index]);i=new Array(x),m(),o=new Array(x),p()}}function m(){if(s)for(var w=0,y=e.length;w<y;++w)i[w]=+n(e[w],w,e)}function p(){if(s)for(var w=0,y=e.length;w<y;++w)o[w]=+r(e[w],w,e)}return d.initialize=function(w,y){s=w,c=y,h()},d.links=function(w){return arguments.length?(e=w,h(),d):e},d.id=function(w){return arguments.length?(t=w,d):t},d.iterations=function(w){return arguments.length?(l=+w,d):l},d.strength=function(w){return arguments.length?(n=typeof w=="function"?w:fe(+w),m(),d):n},d.distance=function(w){return arguments.length?(r=typeof w=="function"?w:fe(+w),p(),d):r},d}const Jc=1664525,Wc=1013904223,Hn=4294967296;function Qc(){let e=1;return()=>(e=(Jc*e+Wc)%Hn)/Hn}function Zc(e){return e.x}function el(e){return e.y}var tl=10,nl=Math.PI*(3-Math.sqrt(5));function il(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=new Map,u=tn(f),c=gt("tick","end"),l=Qc();e==null&&(e=[]);function f(){d(),c.call("tick",t),n<i&&(u.stop(),c.call("end",t))}function d(p){var w,y=e.length,x;p===void 0&&(p=1);for(var b=0;b<p;++b)for(n+=(o-n)*r,a.forEach(function(g){g(n)}),w=0;w<y;++w)x=e[w],x.fx==null?x.x+=x.vx*=s:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=s:(x.y=x.fy,x.vy=0);return t}function h(){for(var p=0,w=e.length,y;p<w;++p){if(y=e[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var x=tl*Math.sqrt(.5+p),b=p*nl;y.x=x*Math.cos(b),y.y=x*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function m(p){return p.initialize&&p.initialize(e,l),p}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),a.forEach(m),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(i=+p,t):i},alphaDecay:function(p){return arguments.length?(r=+p,t):+r},alphaTarget:function(p){return arguments.length?(o=+p,t):o},velocityDecay:function(p){return arguments.length?(s=1-p,t):1-s},randomSource:function(p){return arguments.length?(l=p,a.forEach(m),t):l},force:function(p,w){return arguments.length>1?(w==null?a.delete(p):a.set(p,m(w)),t):a.get(p)},find:function(p,w,y){var x=0,b=e.length,g,k,N,C,S;for(y==null?y=1/0:y*=y,x=0;x<b;++x)C=e[x],g=p-C.x,k=w-C.y,N=g*g+k*k,N<y&&(S=C,y=N);return S},on:function(p,w){return arguments.length>1?(c.on(p,w),t):c.on(p)}}}function rl(){var e,t,n,i,r=fe(-30),o,s=1,a=1/0,u=.81;function c(h){var m,p=e.length,w=on(e,Zc,el).visitAfter(f);for(i=h,m=0;m<p;++m)t=e[m],w.visit(d)}function l(){if(e){var h,m=e.length,p;for(o=new Array(m),h=0;h<m;++h)p=e[h],o[p.index]=+r(p,h,e)}}function f(h){var m=0,p,w,y=0,x,b,g;if(h.length){for(x=b=g=0;g<4;++g)(p=h[g])&&(w=Math.abs(p.value))&&(m+=p.value,y+=w,x+=w*p.x,b+=w*p.y);h.x=x/y,h.y=b/y}else{p=h,p.x=p.data.x,p.y=p.data.y;do m+=o[p.data.index];while(p=p.next)}h.value=m}function d(h,m,p,w){if(!h.value)return!0;var y=h.x-t.x,x=h.y-t.y,b=w-m,g=y*y+x*x;if(b*b/u<g)return g<a&&(y===0&&(y=oe(n),g+=y*y),x===0&&(x=oe(n),g+=x*x),g<s&&(g=Math.sqrt(s*g)),t.vx+=y*h.value*i/g,t.vy+=x*h.value*i/g),!0;if(h.length||g>=a)return;(h.data!==t||h.next)&&(y===0&&(y=oe(n),g+=y*y),x===0&&(x=oe(n),g+=x*x),g<s&&(g=Math.sqrt(s*g)));do h.data!==t&&(b=o[h.data.index]*i/g,t.vx+=y*b,t.vy+=x*b);while(h=h.next)}return c.initialize=function(h,m){e=h,n=m,l()},c.strength=function(h){return arguments.length?(r=typeof h=="function"?h:fe(+h),l(),c):r},c.distanceMin=function(h){return arguments.length?(s=h*h,c):Math.sqrt(s)},c.distanceMax=function(h){return arguments.length?(a=h*h,c):Math.sqrt(a)},c.theta=function(h){return arguments.length?(u=h*h,c):Math.sqrt(u)},c}function ol(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ht(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Se(e){return e=ht(Math.abs(e)),e?e[1]:NaN}function sl(e,t){return function(n,i){for(var r=n.length,o=[],s=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),o.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function al(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var cl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pt(e){if(!(t=cl.exec(e)))throw new Error("invalid format: "+e);var t;return new an({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}pt.prototype=an.prototype;function an(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}an.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ll(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var Vi;function ul(e,t){var n=ht(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-(Vi=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+ht(e,Math.max(0,t+o-1))[0]}function Xn(e,t){var n=ht(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const Un={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:ol,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Xn(e*100,t),r:Xn,s:ul,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Yn(e){return e}var jn=Array.prototype.map,Kn=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function fl(e){var t=e.grouping===void 0||e.thousands===void 0?Yn:sl(jn.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?Yn:al(jn.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function c(f){f=pt(f);var d=f.fill,h=f.align,m=f.sign,p=f.symbol,w=f.zero,y=f.width,x=f.comma,b=f.precision,g=f.trim,k=f.type;k==="n"?(x=!0,k="g"):Un[k]||(b===void 0&&(b=12),g=!0,k="g"),(w||d==="0"&&h==="=")&&(w=!0,d="0",h="=");var N=p==="$"?n:p==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",C=p==="$"?i:/[%p]/.test(k)?s:"",S=Un[k],E=/[defgprs%]/.test(k);b=b===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function M(_){var A=N,v=C,I,W,j;if(k==="c")v=S(_)+v,_="";else{_=+_;var ce=_<0||1/_<0;if(_=isNaN(_)?u:S(Math.abs(_),b),g&&(_=ll(_)),ce&&+_==0&&m!=="+"&&(ce=!1),A=(ce?m==="("?m:a:m==="-"||m==="("?"":m)+A,v=(k==="s"?Kn[8+Vi/3]:"")+v+(ce&&m==="("?")":""),E){for(I=-1,W=_.length;++I<W;)if(j=_.charCodeAt(I),48>j||j>57){v=(j===46?r+_.slice(I+1):_.slice(I))+v,_=_.slice(0,I);break}}}x&&!w&&(_=t(_,1/0));var xe=A.length+_.length+v.length,F=xe<y?new Array(y-xe+1).join(d):"";switch(x&&w&&(_=t(F+_,F.length?y-v.length:1/0),F=""),h){case"<":_=A+_+v+F;break;case"=":_=A+F+_+v;break;case"^":_=F.slice(0,xe=F.length>>1)+A+_+v+F.slice(xe);break;default:_=F+A+_+v;break}return o(_)}return M.toString=function(){return f+""},M}function l(f,d){var h=c((f=pt(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(Se(d)/3)))*3,p=Math.pow(10,-m),w=Kn[8+m/3];return function(y){return h(p*y)+w}}return{format:c,formatPrefix:l}}var Ve,Gi,Ji;dl({thousands:",",grouping:[3],currency:["$",""]});function dl(e){return Ve=fl(e),Gi=Ve.format,Ji=Ve.formatPrefix,Ve}function hl(e){return Math.max(0,-Se(Math.abs(e)))}function pl(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Se(t)/3)))*3-Se(Math.abs(e)))}function wl(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Se(t)-Se(e))+1}function gl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ml(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Vn=Symbol("implicit");function cn(){var e=new _n,t=[],n=[],i=Vn;function r(o){let s=e.get(o);if(s===void 0){if(i!==Vn)return i;e.set(o,s=t.push(o)-1)}return n[s%n.length]}return r.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new _n;for(const s of o)e.has(s)||e.set(s,t.push(s)-1);return r},r.range=function(o){return arguments.length?(n=Array.from(o),r):n.slice()},r.unknown=function(o){return arguments.length?(i=o,r):i},r.copy=function(){return cn(t,n).unknown(i)},gl.apply(r,arguments),r}function Wi(e){return e}function yl(e,t,n,i){var r=Qr(e,t,n),o;switch(i=pt(i??",f"),i.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(o=pl(r,s))&&(i.precision=o),Ji(i,s)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=wl(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=hl(r))&&(i.precision=o-(i.type==="%")*2);break}}return Gi(i)}function xl(e){var t=e.domain;return e.ticks=function(n){var i=t();return Wr(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var r=t();return yl(r[0],r[r.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,o=i.length-1,s=i[r],a=i[o],u,c,l=10;for(a<s&&(c=s,s=a,a=c,c=r,r=o,o=c);l-- >0;){if(c=$t(s,a,n),c===u)return i[r]=s,i[o]=a,t(i);if(c>0)s=Math.floor(s/c)*c,a=Math.ceil(a/c)*c;else if(c<0)s=Math.ceil(s*c)/c,a=Math.floor(a*c)/c;else break;u=c}return e},e}function vl(){var e=0,t=1,n,i,r,o,s=Wi,a=!1,u;function c(f){return f==null||isNaN(f=+f)?u:s(r===0?.5:(f=(o(f)-n)*r,a?Math.max(0,Math.min(1,f)):f))}c.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),i=o(t=+t),r=n===i?0:1/(i-n),c):[e,t]},c.clamp=function(f){return arguments.length?(a=!!f,c):a},c.interpolator=function(f){return arguments.length?(s=f,c):s};function l(f){return function(d){var h,m;return arguments.length?([h,m]=d,s=f(h,m),c):[s(0),s(1)]}}return c.range=l(Zt),c.rangeRound=l(fa),c.unknown=function(f){return arguments.length?(u=f,c):u},function(f){return o=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),c}}function kl(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ee(){var e=xl(vl()(Wi));return e.copy=function(){return kl(e,ee())},ml.apply(e,arguments)}function _l(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}const Qi=_l("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function Ee(e,t,n){this.k=e,this.x=t,this.y=n}Ee.prototype={constructor:Ee,scale:function(e){return e===1?this:new Ee(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ee(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Ee.prototype;let Xt=[];function bl(e){{const t=Xt.map(n=>n.id).join(`
`);e.nextDocumentMode="spw",e.valueStrings.push(t),Xt=[]}}function Zi(){window.spwashi.links.length=0}function Sl(e){window.spwashi.links=window.spwashi.links.filter(t=>t.source!==e&&t.target!==e)}function yd(e){window.spwashi.links=window.spwashi.links.filter(t=>e.includes(t.source)&&e.includes(t.target))}function er(e){return e.sort((t,n)=>t.z-n.z)}function Ut(e,t){const i=document.querySelector("#main-log").querySelector(".events-log");if(!i)return;const r=document.createElement("li");i.appendChild(r);const o=document.createElement("details");r.appendChild(o);const s=document.createElement("summary");if(o.appendChild(s),s.innerText=e,t){const a=document.createElement("pre");a.innerText=t,o.appendChild(a)}}function Nl(e){const t=(n,i)=>{var o,s,a;if(Xt.push(i),Ut("clicked: "+i.id,JSON.stringify(i,null,3)),(s=(o=i.callbacks)==null?void 0:o.click)==null||s.call(o,n,i),n.defaultPrevented)return;let r=window.spwashi.superpower.intent;if(n.key==="x"){i.fx=isNaN(i.fx)?i.x:i.fx;return}if(n.key==="y"){i.fy=isNaN(i.fy)?i.y:i.fy;return}if(n.shiftKey){i.fx=i.fy=void 0;return}if(!(n.key&&n.key!==" ")){switch(n.shiftKey&&(r*=-1),console.log(i),window.spwashi.superpower.name){case"hyperlink":const u=i.url||((a=i.getUrl)==null?void 0:a.call(i));if(i.url=u,!u)break;Ut("hyperlink: "+u);break;case"prune":window.spwashi.nodes.splice(window.spwashi.nodes.indexOf(i),1),Sl(i),window.spwashi.reinit();break;case"alert":if(!i.md5)return;navigator.clipboard.writeText(i.md5).then(c=>{alert(i.md5)});break;case"grow":{i.r+=r;break}case"shrink":{i.r-=r;break}case"colorindex":{i.color=void 0,isNaN(i.colorindex)&&(i.colorindex=1),i.colorindex+=r;break}case"z":{i.z=i.z||0,i.z+=r,er(window.spwashi.nodes);break}}Te()}};return e.append("circle").attr("data-colorindex",n=>"spwashi-datum-"+n.colorindex).attr("r",n=>n.r||1).attr("fill",n=>n.color||void 0).attr("cx",n=>n.x||0).attr("cy",n=>n.y||0).call(Jt().on("start",(n,i)=>{i.x=n.x,i.y=n.y}).on("drag",(n,i)=>{i.fx=n.x,i.fy=n.y}).on("end",(n,i)=>{window.spwashi.tick(),Te()})).on("click",t).on("keydown",(n,i)=>{t(n,i)})}function Cl(e){e.select("circle").attr("stroke",t=>t.stroke).attr("stroke-width",t=>t.strokeWidth||5).attr("fill",t=>t.color||void 0).attr("data-colorindex",t=>t.color?void 0:"spwashi-datum-"+t.colorindex%13).attr("cx",t=>t.x||0).attr("r",t=>t.r||1).attr("cy",t=>t.y||0)}function Ml(e){const t=e.append("a");t.attr("href",i=>i.url||void 0),t.attr("target",i=>"_blank");const n=t.append("text");return n.attr("x",i=>i.x).attr("font-size",i=>i.text.fontSize||i.r).call(Jt().on("start",(i,r)=>{r.text.fx=r.text.fx||0,r.text.fy=r.text.fy||0,Ut("clicked: "+r.id,JSON.stringify(r,null,3))}).on("drag",(i,r)=>{r.fx=i.x,r.fy=i.y}).on("end",(i,r)=>{})),n.selectAll("tspan").data(i=>Dt(i).split(`
`).map((r,o)=>({node:i,i:o,text:r}))).join(i=>i.append("tspan").attr("text-anchor","middle").attr("dy",r=>r.node.r*2).attr("dx",0),i=>i.selectAll("tspan").text(r=>r.text),i=>i.selectAll("tspan").remove()),e}function El(e){const t=e.select("a");return t.attr("href",i=>i.url||void 0),t.select("text").attr("x",i=>(i.x||0)+(i.text.fx||0)).attr("y",i=>(i.y||0)+(i.text.fy||0)-Dt(i).split(`
`).length*i.r/2).attr("font-size",i=>i.text.fontSize||i.r).selectAll("tspan").data(i=>Dt(i).split(`
`).map((r,o)=>({node:i,i:o,text:r}))).text(i=>i.text).attr("x",i=>(i.node.x||0)+(i.node.text.fx||0)),e}function Al(e){return e.append("rect")}function Tl(e){return e.append("rect").attr("width",t=>window.spwashi.getNodeImageHref(t)?t.image.r||t.r:0).attr("height",t=>window.spwashi.getNodeImageHref(t)?t.image.r||t.r:0).attr("x",t=>t.x+t.image.offsetX-t.image.r/2).attr("y",t=>t.y+t.image.offsetY-t.image.r/2),e.append("image").attr("href",window.spwashi.getNodeImageHref).attr("width",t=>t.image.r||t.r).attr("height",t=>t.image.r||t.r).attr("preserveAspectRatio",t=>"xMidYMin slice").attr("x",t=>t.x+t.image.offsetX).attr("y",t=>t.y+t.image.offsetY).attr("stroke",_i).attr("stroke-width",2).call(Jt().on("start",(t,n)=>{}).on("drag",(t,n)=>{n.image.offsetX+=t.dx,n.image.offsetY+=t.dy}).on("end",(t,n)=>{Te()})).on("error",(t,n)=>{n.image.href=null,n.image.r=0}).on("click",(t,n)=>{if(event.defaultPrevented)return;let i=window.spwashi.superpower.intent;switch(t.shiftKey&&(i*=-1),window.spwashi.superpower.name){case"grow":{n.image.r=n.image.r||n.r,n.image.r+=i;break}case"shrink":{n.image.r=n.image.r||n.r,n.image.r-=i;break}case"colorindex":{isNaN(n.colorindex)&&(n.colorindex=1),n.colorindex+=i;break}}Te()}),e}function Il(e){e.select("rect").attr("stroke","black").attr("x",t=>t.x+t.image.offsetX-t.image.r/2).attr("y",t=>t.y+t.image.offsetY-t.image.r/2).attr("width",t=>window.spwashi.getNodeImageHref(t)?t.image.r:0).attr("height",t=>window.spwashi.getNodeImageHref(t)?t.image.r:0),e.select("image").attr("href",window.spwashi.getNodeImageHref).attr("width",t=>t.image.r).attr("height",t=>t.image.r).attr("x",t=>t.x+t.image.offsetX-t.image.r/2).attr("y",t=>t.y+t.image.offsetY-t.image.r/2)}function Ol(e){window.spwashi.nodes=e}function ln(){window.spwashi.nodes=[]}function Dl(){window.spwashi.nodes=window.spwashi.nodes.filter(e=>e.kind!=="__cluster"),window.spwashi.links=window.spwashi.links.filter(e=>e.source.kind!=="__cluster"&&e.target.kind!=="__cluster")}function xd(e){window.spwashi.nodes.length=Math.max(0,window.spwashi.nodes.length-e)}function $l(e,t,n){const i={image:{},callbacks:{},charge:0,parts:{},private:{},text:{fontSize:20},r:1*window.spwashi.parameters.nodes.radiusMultiplier,z:0,x:window.spwashi.parameters.startPos.x+n*2,y:window.spwashi.parameters.startPos.y,colorindex:ge()};return Object.assign(e,i,t,{name:e.identity||"node:"+n,idx:n},{...e}),e.r=Math.max(e.r,1),e.image.r=isNaN(e.image.r)?e.r:Math.max(10,e.image.r),e.image.offsetX=isNaN(e.image.offsetX)?0:e.image.offsetX,e.image.offsetY=isNaN(e.image.offsetY)?e.r:e.image.offsetY,e}function Rl(e,t=void 0){let n;return window.spwashi.nodes.find(r=>{if(r.identity===e)return n=n||r,t===void 0?!0:r.colorindex===t;r.id===e&&(n=n||r)})||n}const Gn=new Map;function Ll(e={},t=0){return e.identity?e.identity:`node:[${t}]`}function zl(e,t){const n=Ll(e,t),i=Gn.get(n)||new Set;return i.has(e)||(e.id=n+(i.size?"["+i.size+"]":""),i.add(e)),e.id=e.id||n,Gn.set(e.id,i),e.id}function Pl(e){return!0}const q={getNode:Rl,initNodes:Fl,normalize:$l,updateNodes:Bl,filterNode:Pl,processNode:Fe,cacheNode:Te};function Fl(e){const t=e.length;for(let i=0;i<t;i++){const r={id:zl(e[i],i)},o=Xr(r);q.normalize(e[i],{...r,...o},i)}const n=er(e);return Ol(n),n}function Bl(e,t){const n=e.select(".nodes").selectAll("g.wrapper").data(t,s=>s.id),i=s=>{const a=s.append("g").classed("wrapper",!0),u=a.append("g").classed("image",!0),c=a.append("g").classed("node",!0),l=a.append("g").classed("text",!0);return Tl(u),Nl(c),Al(c),Ml(l),a},r=s=>{const a=s.select("g.node"),u=s.select("g.image"),c=s.select("g.text");return Cl(a),El(c),Il(u),a.select("rect").attr("stroke-width","1px").attr("fill",Ur).attr("stroke",_i).attr("fill","none").attr("x",l=>l.x-l.r).attr("y",l=>l.y-l.r),s},o=s=>{s.select("g.node").remove(),s.select("g.text").remove(),s.select("g.image").remove()};n.join(i,r,o)}const ql="modulepreload",Hl=function(e){return"/"+e},Jn={},un=function(t,n,i){if(!n||n.length===0)return t();const r=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=Hl(o),o in Jn)return;Jn[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!i)for(let l=r.length-1;l>=0;l--){const f=r[l];if(f.href===o&&(!s||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":ql,s||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),s)return new Promise((l,f)=>{c.addEventListener("load",l),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})},Xl="hotkey-menu",fn="standard",dn="minimalism",Ul="main-menu";function hn(e){let t;if(e){const n=e.indexOf(document.body.dataset.interfaceDepth),i=e.filter((r,o)=>o!==n);t=i[n+1]||i[0]}else window.spwashi.minimalism?t=dn:t=fn;document.body.dataset.interfaceDepth=t}function Yl(){const e=document.querySelector("#mainmenu-toggle");e&&(e.onclick=()=>hn([Ul,window.spwashi.minimalism?dn:fn]))}function jl(){hn([Xl,window.spwashi.minimalism?dn:fn])}function Kl(){const e=document.querySelector("#keystroke-options");e.innerHTML="";const t=document.querySelector("#hotkey-menu-toggle");t.onclick=i=>{jl()};const n=e.appendChild(document.createElement("UL"));window.spwashi.keystrokeOptions.filter(i=>i.revealOrder<=window.spwashi.keystrokeRevealOrder).forEach(({shortcut:i,categories:r=[],title:o,callback:s,shortcutName:a})=>{const u=()=>{s()},c=n.appendChild(document.createElement("LI"));if(!o)return;const l=c.appendChild(document.createElement("SPAN"));l.className="ctg",l.innerHTML=r.map(h=>`<span>[${h}]</span>`).join("");const f=c.appendChild(document.createElement("BUTTON"));f.onclick=u,f.innerHTML=o;const d=c.appendChild(document.createElement("KBD"));d.innerHTML=`ctrl + <strong>${a||i}</strong>`})}function vd(e){return{identity:e.identity,name:e.name,x:e.x,y:e.y,fx:e.fx,fy:e.fy,r:e.r,id:e.id,image:e.image.href?e.image:void 0,md5:e.md5,colorindex:e.colorindex}}function tr(e){const t=JSON.parse(e);return Array.isArray(t)?{nodes:t||[],links:[]}:t.nodes&&Array.isArray(t.nodes)?{nodes:t.nodes,links:t.links||[]}:(console.error("not nodes"),{nodes:[],links:[]})}function Vl(){window.spwashi.refreshNodeInputs=n=>{const i=document.querySelector("#nodes-input"),r=window.spwashi.getItem("parameters.nodes-input")||[];i.value=JSON.stringify(r)},window.spwashi.readNodeInputs=()=>{var i;const n=(i=document.querySelector("#nodes-input"))==null?void 0:i.value;return n?tr(n):(window.spwashi.setItem("parameters.nodes-input",null),reject())},window.spwashi.refreshNodeInputs(),z(...window.spwashi.readNodeInputs().nodes.filter(q.filterNode)),D(Fe),window.spwashi.reinit();const e=document.querySelector("#nodes-input");e.onfocus=()=>e.select();const t=(n=!0)=>{const i=window.spwashi.readNodeInputs().nodes;n||(ln(),window.spwashi.reinit()),z(...i),window.spwashi.reinit(),L("")};document.querySelector("#controls button.read-nodes").onclick=()=>t(!0),document.querySelector("#node-input-container button.add").onclick=()=>t(!0),document.querySelector("#node-input-container button.replace").onclick=()=>t(!1),document.querySelector("#controls button.save-nodes").onclick=()=>{const n=H();n.map(q.cacheNode),window.spwashi.setItem("parameters.nodes-input",n),window.spwashi.refreshNodeInputs()},document.querySelector("#controls button.clear-saved-nodes").onclick=()=>{const n=H();n.map(i=>{const r=i.id;for(let o in i)delete i[o];i.id=r,q.cacheNode(i)}),n.length=0,window.spwashi.reinit(),L("")}}function Gl(e){return se(window.spwashi.links,...gi(e))}function Jl(e,t){e.select(".links").selectAll("line").data(t).join(n=>n.append("line").attr("stroke-width",i=>(i.strength||1)*13).attr("x1",i=>i.source.x).attr("y1",i=>i.source.y).attr("x2",i=>i.target.x).attr("y2",i=>i.target.y),n=>n.attr("x1",i=>i.source.x).attr("data-colorindex",i=>"spwashi-stroke-"+i.colorindex).attr("y1",i=>i.source.y).attr("x2",i=>i.target.x).attr("y2",i=>i.target.y),n=>n.remove())}const Wl={initLinks:Gl,updateLinks:Jl};function nr(e){const t=tr(e);if(t.nodes.length===0)return!1;const n=t.nodes.filter(q.filterNode);n.forEach(q.processNode),z(...n);const i=Wl.initLinks(t.links,n);se(window.spwashi.links,...i),window.spwashi.reinit()}function Ql(e){window.spwashi.keystrokeOptions=e}function ir(){Yl(),window.spwashi.keystrokeRevealOrder=window.spwashi.keystrokeRevealOrder||0;function e(t,n){const i=window.spwashi.modeOrder.map((o,s)=>[s+1,()=>L(o,!0,!0)]),r=Object.fromEntries(i);if(!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)){if(t==="/"){n.preventDefault(),document.querySelector("h1").click();return}if(r[t]){n&&n.preventDefault(),r[t]();return}switch(t){case"ArrowRight":window.spwashi.callbacks.arrowRight();break;case"ArrowLeft":window.spwashi.callbacks.arrowLeft();break;case"ArrowUp":window.spwashi.callbacks.arrowUp();break;case"ArrowDown":window.spwashi.callbacks.arrowDown();break}}}document.addEventListener("paste",t=>{if(t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA")return;const i=(t.clipboardData||window.clipboardData).getData("Text");return nr(i)}),document.addEventListener("keydown",t=>{const n=t.key;if(n==="Escape"&&(document.querySelector("#mode-container :is(:focus)"),L("")),!t.shiftKey){if(t.metaKey||t.ctrlKey){for(let i of window.spwashi.keystrokeOptions)n===i.shortcut&&(t.preventDefault(),i.callback());return}e(n,t)}}),un(()=>import("./keystrokes-KWbeOjQY.js"),__vite__mapDeps([])).then(({initialKeyStrokeOptions:t})=>{window.spwashi.keystrokeOptions=t,Kl(),Ql(t)})}const rr="extended menu".trim();function Zl(){window.spwashi.keystrokeRevealOrder=1,ir()}function eu(){ln(),Zi(),window.spwashi.perspectiveMap.delete(ge()),window.spwashi.reinit()}const tu=(e,t)=>e.fy=75*(t+1),nu=(e,t)=>e.fx=75;async function*iu(e){for(let{delay:t,payload:n}of e)await new Promise(i=>setTimeout(i,t)),yield n}async function or(e){for await(const t of iu(e)){if(t.effect&&t.effect(),t.params&&ze(new URLSearchParams(t.params)),t.nodes){const n=t.nodes.map(Fe).map(q.normalize);z(...n)}window.window.spwashi.reinit()}}function pn(e){const t=document.querySelector("#spw-parse-field");t.value=e,t.focus();const n=t.value.indexOf("&");t.setSelectionRange(n,n+1)}function ru(){for(let e in de)de.hasOwnProperty(e)&&delete de[e]}function sr(){return["< & >","( & )","{ & }","[ & ]"]}function ar(){return["context","topic","structure","status"]}const Mt=sr(),Et=ar();function wt(e=!1){ru();const t=Et.shift();if(!t||e){Mt.length=0,Et.length=0,Mt.push(...sr()),Et.push(...ar()),wt();return}de[t]={params:{superpower:"hyperlink"},events:[{delay:300,payload:{params:{mode:"spw"}}},{delay:300,payload:{effect:()=>pn(Mt.shift())}},{delay:300,payload:{effect:wt}}]},cr()}const de={};wt();de.demo={params:{width:300,height:500,superpower:"hyperlink",velocityDecay:.9,center:"150,250"},runStory:()=>{or([{delay:50,payload:{nodes:[{r:10,x:30,y:50,text:{fx:75,fontSize:30},name:"hello"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:100,text:{fx:75,fontSize:30},name:"how"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:150,text:{fx:75,fontSize:30},name:"are"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:200,text:{fx:75,fontSize:30},name:"you"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:250,text:{fx:75,fontSize:30},name:"doing"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:300,text:{fx:75,fontSize:30},name:"today"}]}},{delay:300,payload:{params:{charge:500}}},{delay:50,payload:{params:{charge:0}}},{delay:50,payload:{effect:()=>D((i,r)=>(nu(i),tu(i,r)))}},{delay:300,payload:{effect:()=>eu()}},{delay:100,payload:{params:{mode:"spw"}}},{delay:300,payload:{effect:()=>pn("i am doing & today")}}]).then(console.log)}};de.options={events:[{delay:300,payload:{params:{mode:"spw"}}},{delay:100,payload:{effect:()=>pn(rr)}},{delay:1e3,payload:{effect:()=>{window.spwashi.keystrokeRevealOrder=1}}}]};function cr(){const e=document.querySelector("#story-mode-container");e.innerHTML="";const t=document.createElement("div");t.classList.add("button-container"),e.appendChild(t),Object.entries(de).forEach(([n,i])=>{const r=document.createElement("button");r.innerText=n,r.onclick=()=>{ze(new URLSearchParams(i.params)),i.runStory&&i.runStory(),i.events&&or(i.events)},t.appendChild(r)})}function ou(){const e=document.querySelector("#colors");e.onclick=function(t){const i=t.target.dataset.dataindex;di(i),L(null)}}function su(){wt(!0),document.querySelector(`#colors button[data-dataindex=${fi(ge())}]`).focus();const e=document.querySelectorAll("#colors button"),t={},n={};e.forEach(o=>{const s=o.getBoundingClientRect(),a=Math.round(s.x),u=Math.round(s.y);t[a]||(t[a]=[]),n[u]||(n[u]=[]),t[a].push(o),n[u].push(o)});const i=Object.keys(t).sort((o,s)=>o-s).map((o,s)=>{const a=t[o];return a.forEach(u=>u.dataset.x=s),a}),r=Object.keys(n).sort((o,s)=>o-s).map((o,s)=>{const a=n[o];return a.forEach(u=>u.dataset.y=s),a});window.spwashi.callbacks.arrowUp=()=>{const o=parseInt(document.activeElement.dataset.x),s=i[o],a=s.indexOf(document.activeElement),u=a?a-1:s.length-1;s[u].focus()},window.spwashi.callbacks.arrowDown=()=>{const o=parseInt(document.activeElement.dataset.x),s=i[o],a=s.indexOf(document.activeElement),u=a===s.length-1?0:a+1;s[u].focus()},window.spwashi.callbacks.arrowRight=()=>{const o=parseInt(document.activeElement.dataset.y),s=r[o],a=s.indexOf(document.activeElement),u=a===s.length-1?0:a+1;s[u].focus()},window.spwashi.callbacks.arrowLeft=()=>{const o=parseInt(document.activeElement.dataset.y),s=r[o],a=s.indexOf(document.activeElement),u=a?a-1:s.length-1;s[u].focus()}}function au(){const e=()=>{};window.spwashi.callbacks.arrowUp=e,window.spwashi.callbacks.arrowDown=e,window.spwashi.callbacks.arrowLeft=e,window.spwashi.callbacks.arrowRight=e}function cu(){document.body.dataset.interfaceDepth="standard"}function lu(){Tr(),window.spwashi.onModeChange=(e,t=!1)=>{var i,r,o,s,a;e&&window.spwashi.setItem("mode",e,"focal.root"),(i=document.querySelector('[data-mode-action] [aria-selected="true"]'))==null||i.setAttribute("aria-selected","false");const n=document.querySelector(`#mode-selector--${e}`);switch(n&&(n.setAttribute("aria-selected","true"),Pe(),document.body.dataset.interfaceDepth==="main-menu"?Cr(n):U.fx||Ae({x:window.innerWidth*.2,y:window.innerHeight*.75})),au(),e){case"spw":const u=document.querySelector("#spw-mode-container");u.tabIndex=0,t&&u.focus();break;case"reflex":Lr();break;case"color":su();break;case"story":const l=document.querySelector("#story-mode-container").querySelector(".button-container button");l.focus(),l.onfocus=()=>l.tabIndex=0;break;case"node":const f=document.querySelector("#node-input-container");f.tabIndex=0,f.focus(),f.onfocus=()=>f.tabIndex=0;break;case"map":(o=(r=window.spwashi.callbacks).onMapMode)==null||o.call(r);break;case"filter":(a=(s=window.spwashi.callbacks).onFilterMode)==null||a.call(s);break}cu()},window.spwashi.onDataIndexChange=e=>{}}function uu(e){const t=new Image;return t.src=e,window.spwashi.setItem("parameters.page-image.url",e),t}function wn(){const e=document.querySelector("#main-image-container");e.innerHTML="";const t=window.spwashi.getItem("parameters.page-image.url");if(t){const n=new Image;n.src=t,e.appendChild(n)}}function fu(){window.location.href="/"}function du(e){{e.valueStrings.push("add=10"),e.valueStrings.push("bonk"),e.valueStrings.push("boundingBox=1"),e.valueStrings.push("charge=-100"),e.valueStrings.push("velocityDecay=0.9"),e.valueStrings.push("nodeCount=1"),e.valueStrings.push("boon"),e.valueStrings.push("bonk"),e.valueStrings.push("nodeCount=3"),e.valueStrings.push("boon"),e.valueStrings.push("bonk"),e.valueStrings.push("minimalism"),e.nextDocumentMode="spw";return}}function hu(e){{const t=pi(n=>n.id).join(`
`);e.valueStrings.push(t),e.nextDocumentMode="spw";return}}function pu(){const e=H();D(q.cacheNode),window.spwashi.setItem("parameters.nodes-input",e),window.spwashi.setItem("parameters.nodes-input-map-fn-string","data => data"),window.spwashi.refreshNodeInputs()}function wu(){pu()}function Wn(){D(e=>{e.fx=e.fy=void 0})}function gu(){D(e=>{e.fx=e.x,e.fy=e.y})}function mu(e){return"cluster:"+e.colorindex}function yu(e){const t=window.spwashi.nodes.reduce((n,i)=>{const r=mu(i);return n[r]=n[r]||[],n[r].push(i),n},{});Dl(),Object.entries(t).forEach(([n,i])=>{const r={identity:n,kind:"__cluster",r:100};z(r),i.forEach(o=>{se(window.spwashi.links,{source:r,target:o,strength:1})})}),e.physicsChange=!0}function xu(){{window.spwashi.minimalism=!0,hn(),document.body.dataset.displaymode="nodes";return}}function vu(e){D(t=>{t.x=Math.random()*1e3,t.y=Math.random()*1e3}),e.physicsChange=!0}function ku(e){const t=H();t.forEach((n,i)=>{const r=t[i],o=t[(i+1)%t.length];se(window.spwashi.links,{source:r,target:o,strength:.1})}),e.physicsChange=!0}function _u(){{window.spwashi.bone();return}}function bu(){D(e=>{e.stroke="red"})}function Su(){{window.spwashi.boon();return}}function Nu(){{window.spwashi.honk();return}}function Cu(){{window.spwashi.bonk();return}}function Mu(e){const t=document.querySelector("title").innerText;e.nextDocumentMode="spw",e.valueStrings.push(`${t}`)}function Eu(){{const e=new URLSearchParams;e.set("display","nodes"),ze(e)}}function Au(){{window.spwashi.setItem("parameters.page-image",""),wn();return}}function Tu(){ln(),Zi(),window.spwashi.reinit(),Pe().focus()}function Iu(){const e=window.spwashi.simulation,t=window.spwashi.links,n=H();e.alpha(window.spwashi.parameters.forces.alpha),e.alphaTarget(window.spwashi.parameters.forces.alphaTarget),e.alphaDecay(window.spwashi.parameters.forces.alphaDecay),e.velocityDecay(window.spwashi.parameters.forces.velocityDecay),e.force("link",Gc().links(t).id(i=>i.id).strength(i=>i.strength||1)),e.force("collide",Kc(i=>i.collisionRadius||i.r)),e.force("charge",null),e.force("charge",rl().strength(i=>i.charge||window.spwashi.parameters.forces.charge)),e.force("center",Ec(window.spwashi.parameters.forces.centerPos.x,window.spwashi.parameters.forces.centerPos.y).strength(window.spwashi.parameters.forces.centerStrength)),e.force("boundingBox",null),window.spwashi.parameters.forces.boundingBox&&e.force("boundingBox",i=>{for(let r=0,o=n.length,s=i*.1;r<o;++r){const a=n[r];a.x>window.spwashi.parameters.width?(a.x=window.spwashi.parameters.width,a.vx*=.9):a.x<0&&(a.x=0,a.vx*=.9),a.y>window.spwashi.parameters.height?(a.y=window.spwashi.parameters.height,a.vy*=.9):a.y<0&&(a.y=0,a.vy*=.9)}})}function Ou(e){Iu(),e.physicsChange=!0}function Du(e){const t=e.valueStrings[0];D(n=>n.collisionRadius=parseInt(t)),e.physicsChange=!0}function $u(e){e.valueStrings.push("https://spwashi.com","https://lore.land","https://boon.land","https://bane.land","https://bone.land","https://bonk.land","https://honk.land","https://boof.land","https://factshift.com"),e.nextDocumentMode="spw"}function Ru(e){const t=H(),n=[cn(Qi),ee([0,t.length],i=>`hsl(${i*360}, 100%, 50%)`)][1];t.forEach((i,r)=>{i.color=n(r)})}function Lu(e){const t=H(),n=window.spwashi.parameters.width,i=window.spwashi.parameters.height;t.forEach((r,o)=>{r.x=o%5*n/5,r.y=Math.floor(o/5)*i/5}),e.nodesImpacted=t,e.physicsChange=!0}const zu=e=>{e.valueStrings.push(...Object.keys(Yt).filter(t=>!["options","clear","save","home","help"].includes(t)).map(t=>t+`
`)),e.nextDocumentMode="spw"},Yt={home:()=>fu(),clear:()=>Tu(),save:()=>wu(),freeze:()=>gu(),unfreeze:()=>Wn(),unfix:()=>Wn(),help:e=>Er(e),spwashi:e=>$u(e),color:e=>Ru(),forces:e=>Ou(e),cr:e=>Du(e),all:e=>hu(e),clicked:e=>bl(e),cluster:e=>yu(e),scatter:e=>vu(e),arrange:e=>Lu(e),demo:e=>du(e),link:e=>ku(e),title:e=>Mu(e),minimalism:()=>xu(),boon:()=>Su(),bane:()=>bu(),bone:()=>_u(),honk:()=>Nu(),bonk:()=>Cu(),nodesonly:()=>Eu(),noimage:()=>Au(),[rr]:()=>Zl(),options:zu};function Pu(e,t){e.valueStrings.push(t),e.liveStrings.push(t)}function Fu(e,t){return Yt[e]?Yt[e](t):Pu(t,e)}const Bu={regex:/^add=(-?\d+)/,handler:(e,t)=>{const n=parseInt(t),i=[...Array(n)].map((r,o)=>({name:o+"",id:Date.now()+Math.random()}));z(...i.map(q.normalize).map(Fe)),e.nodesAdded.push(...i),e.physicsChange=!0}},qu={regex:/^@=(.+)/,handler:(e,t)=>{t.split(",").forEach(i=>{const r=window.spwashi.nodes.find(o=>o.id===i||o.identity===i);r&&e.nodesImpacted.push(r)}),e.physicsChange=!0}},Hu={regex:/^box=(-?\d+)/,handler:(e,t)=>{window.spwashi.parameters.forces.boundingBox=!!parseInt(t),e.physicsChange=!0}},Xu={regex:/^charge=(-?\d+)/,handler:(e,t)=>{window.spwashi.parameters.forces.charge=parseInt(t),e.physicsChange=!0}},Uu={regex:/^cr=(\d+)/,handler:(e,t)=>{D(n=>n.collisionRadius=parseInt(t)*n.r),e.physicsChange=!0}},Yu={regex:/^color=(-?\d+)/,handler:(e,t)=>{const n=parseInt(t),i=Math.sign(n)!==-1||Object.is(n,-0),r=[...window.spwashi.nodes];i&&r.reverse();const o=[cn(Qi),ee([0,r.length],a=>`hsl(230, ${a*100}%, 50%)`),ee([0,r.length],a=>`hsl(230, 100%, ${a*50}%)`),ee([0,r.length],a=>`hsl(${a*360}, 100%, 50%)`)],s=o[Math.abs(n)%o.length];r.forEach((a,u)=>{console.log(a.name),a.color=s(u)}),e.physicsChange=!0}},ju={regex:/^fontSize=(\d+)/,handler:(e,t)=>{const n=parseInt(t);H().forEach((r,o)=>{r.text.fontSize=n}),e.physicsChange=!0}},Ku={regex:/^name=(.+)/,handler:(e,t)=>{const n=t,i=H(),o={identity:s=>s.identity,name:s=>s.private.name||s.name,url:s=>s.url,hash:s=>ki(s),pos:(s,a)=>`${a}`}[n];o&&(i.forEach((s,a)=>{s.private.name=s.private.name||s.name,s.name=o(s,a)||s.name}),e.physicsChange=!0)}},Vu={regex:/^nodeCount=(\d+)/,handler:(e,t)=>{window.spwashi.parameters.nodes.count=parseInt(t),e.physicsChange=!0}},Gu={regex:/^r=(\d+)/,handler:(e,t)=>{D(n=>n.r=parseInt(t)),e.physicsChange=!0}},Ju={regex:/^size=(\d+)/,handler:(e,t)=>{const n=parseInt(t),i=H(),r=[ee([0,i.length],s=>s*30),ee([0,i.length],s=>s*60),ee([0,i.length],s=>s*90),ee([0,i.length],s=>s*120)],o=r[n%r.length];i.forEach((s,a)=>{s.r=o(a)}),e.physicsChange=!0}},Wu={regex:/^sort=(.+)/,handler:(e,t)=>{const n=t,i=H(),o={name:(s,a)=>s.name.localeCompare(a.name),"name+":(s,a)=>s.name.localeCompare(a.name),"name-":(s,a)=>a.name.localeCompare(s.name),r:(s,a)=>s.r-a.r,"r+":(s,a)=>s.r-a.r,"r-":(s,a)=>a.r-s.r,cluster:(s,a)=>s.colorindex-a.colorindex,"cluster-":(s,a)=>s.colorindex-a.colorindex,"cluster+":(s,a)=>a.colorindex-s.colorindex,z:(s,a)=>s.z-a.z,"z+":(s,a)=>s.z-a.z,"z-":(s,a)=>a.z-s.z}[n];o&&(i.sort(o),e.physicsChange=!0)}},Qu={regex:/^!(.+)/,handler:(e,t)=>{window.spwashi.superpower={name:t,intent:1},e.physicsChange=!0}},Zu={regex:/^https:\/\/(.+)/,handler:(e,t)=>{const n={name:t,url:`https://${t}`,collisionRadius:30,r:20,charge:-1e3,fx:window.spwashi.parameters.width/2};z(n),e.nodesAdded.push(n),e.valueStrings.push(n.url)}},ef={regex:/^velocityDecay=(-?\d*\.?\d+)/,handler:(e,t)=>{window.spwashi.parameters.forces.velocityDecay=parseFloat(t),e.physicsChange=!0}},tf={at:qu,add:Bu,box:Hu,charge:Xu,velocityDecay:ef,nodeQueue:Vu,collisionRadius:Uu,radius:Gu,superpower:Qu,url:Zu,color:Yu,size:Ju,sort:Wu,name:Ku,fontSize:ju};function nf(e,t){let n=!1;if(Object.entries(tf).forEach(([i,{regex:r,handler:o}])=>{const s=r.exec(e);if(s&&s[1]){n=!0;const a=s.slice(1);o(t,...a)}}),!n)return Fu(e,t),!1}function rf(){const e=window.spwashi.getItem("parameters.spw-parse-field")||"",t=document.querySelector("#spw-parse-field");return t.value=e,t.addEventListener("paste",n=>{const i=(n.clipboardData||n.originalEvent.clipboardData).items;for(const o of i)if(o.type.indexOf("image")===0){const s=o.getAsFile();var r=new FileReader;r.onload=function(a){const u=a.target.result;uu(u)},r.readAsDataURL(s),wn()}}),t}function lr(e){const t={physicsChange:!1,nextDocumentMode:"",liveStrings:[],valueStrings:[],nodesAdded:[],nodesImpacted:[],nodesIgnored:[]},n={};return D(r=>{r.stroke=void 0,n[r.id]=r}),e.split(`
`).map(r=>{if(n[r]){t.nodesIgnored.push(n[r]);return}nf(r,t)}),t.nodesAdded.forEach(r=>{r.stroke="red",q.normalize(r),Fe(r)}),t.nodesIgnored.forEach(r=>{r.r=10}),t.nodesImpacted.forEach(r=>{r.stroke="rgb(222,184,135)",r.strokeWidth=5}),t.physicsChange&&window.spwashi.reinit(),{nextDocumentMode:t.nextDocumentMode,liveStrings:t.liveStrings,valueStrings:t.valueStrings}}class He{constructor(t,n=void 0,i=!1){this._head=t,this._operator=n,this._isPrefixed=i}operator(t){if(!t)return this._operator;this._operator=t}get parts(){const t=[this._head,this._operator];return this._isPrefixed?t.reverse():t}}class of extends He{}class sf extends He{get parts(){return this._isPrefixed?super.parts.reverse():super.parts}}class af extends He{}class cf extends He{}class lf{constructor(t){this._seedNode=t,this.fillOperator=uf(t)}get seedNode(){return this._seedNode}initTail(){const t=this.seedNode;if(!t.tail)return;this._trailingOperator;const n=t.tail;return this._tail=new cf(n),this._tail}initBody(){const t=this.seedNode,n=t==null?void 0:t.body;if(!n)return;const i=[];for(const r of n)this._trailingOperator=this.fillOperator(),i.push(new sf(r,this._trailingOperator,!1));return this._body=new af(i),this._body}initHead(){const t=this.seedNode;let n=this.fillOperator();return t.head&&(this._head=new of(t.head,n),n=void 0),this._trailingOperator=n,this._head}*produce(){const t=this.initHead();t&&(yield t);const n=this.initBody();n&&(yield n);const i=this.initTail();i&&(yield i)}}function uf(e){let t=0;return function(){var n;const i=(n=e.operators)===null||n===void 0?void 0:n[t];return t++,i}}class gn{constructor(t,n=void 0){var i,r;this._generation=((i=t==null?void 0:t._generation)!==null&&i!==void 0?i:-1)+1,this._context=n??t,this._root=(r=t._root)!==null&&r!==void 0?r:t}spawn(t){return new gn(this,t)}key(t){return t}*loop(t){if(Array.isArray(t)){for(const i of t)yield t;return}if(!t)return;yield*new lf(t).produce()}}class ur{constructor(t=void 0){this.generators=[],this.Cursor=fr,this.source=t}getCursor(t){return new this.Cursor({input:t,generators:this.generators})}*locate(t){yield new gn(t)}}class Le extends ur{reduce(t,n=void 0){if(t instanceof He)return this._reduceArray(t.parts,n);if(typeof t>"u"||t===null){this._reduceNothing();return}return Array.isArray(t)?this._reduceArray(t,n):typeof t=="string"?this._reduceString():t.key?this._reduceAtom(t,n):this._reduceNode(t,n)}_reduceNode(t,n){const i=n.spawn(t),r=[];for(const a of i.loop(t)){const u=this.reduce(a,i);u&&r.push(u)}const o=Le.doFlatten?r.flat():r;return(Le.doFlatten?!1:!n.generation)?{kind:t.kind,key:o}:o}_reduceNothing(){}_reduceAtom(t,n){return n.key(t)}_reduceString(){return null}_reduceArray(t,n){const i=[];for(const r of t){const o=this.reduce(r,n);o&&i.push(o)}return i.length<2?i[0]:i.flat()}}Le.doFlatten=!0;class vt{constructor(t){this._kind=[],this.cursor=t}set kind(t){this._kind.push(t)}get kind(){return this._kind.join(" ")}get identity(){const t=[],n=new Le(this);for(const r of n.locate(this)){const o=n.reduce(this,r);o&&t.push(o)}this.head,this.body,this.tail,this.kind;function i(r){return r.key?r.key:Array.isArray(r)?r.map(i).join(""):r}return t.reduce((r,o)=>""+r+i(o),"")}toJSON(){return Object.fromEntries(Object.entries({identity:this.identity,kind:[...this._kind].join(vt.kindJunctionStr),head:this.head,body:this.body,tail:this.tail}).filter(([,t])=>!!t))}}vt.kindJunctionStr=" + ";var Ge=function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},Je=function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},tt,re;class fr{constructor(t,n){var i;tt.set(this,void 0),re.set(this,void 0),this.__log_taken=[],this.offset=(t==null?void 0:t.offset)||0,this.start=(i=n==null?void 0:n.start)!==null&&i!==void 0?i:this.offset,this.input=t==null?void 0:t.input,this.generators=t==null?void 0:t.generators,this.level=typeof(t==null?void 0:t.level)<"u"?t.level+1:0,Ge(this,tt,n||t||void 0,"f"),Ge(this,re,null,"f")}spawn(t){const n=this.constructor;return new n(this,t)}get parent(){return Je(this,tt,"f")}setOffset(t){this.offset=t.offset}curr(){return this.input[this.offset]}*scan(t=void 0,n){const i=t??this.generators;if(!i)throw new Error("Cannot scan without generators");let r=n;for(const o of i){const s=yield*o(this,r),a=s?s.getToken():!1;a&&(this.setOffset(s),a!==(r==null?void 0:r.getToken())&&(yield s),r=s)}return r}*log(t){{const n="	".repeat(this.level);yield`${n}${this}`,yield`${n}	${t.message}`,t.miss&&(yield`${n}		reason: ${t.miss}`)}}*take(){const t=this.pos();return this.__log_taken.push(t),yield t,this.advance(),t}advance(){this.offset=this.offset+1}pos(){return{kind:"pos",offset:this.offset}}getToken(){return Je(this,re,"f")}token(t){var n;return t===!1?(Ge(this,re,t,"f"),this):(Ge(this,re,(n=Je(this,re,"f"))!==null&&n!==void 0?n:new vt(this),"f"),Object.assign(Je(this,re,"f"),t),this)}static isCursorPosition(t){return t?typeof t.offset<"u"&&t.kind==="pos":!1}}tt=new WeakMap,re=new WeakMap;class mn extends fr{static isCharacterCursor(t){return typeof(t==null?void 0:t.start)<"u"}toString(){const t=this.toJSON();return`(line: ${t.start.line}, col: ${t.start.col})`}pos(){return Object.assign(Object.assign({},super.pos()),{key:this.curr()})}toJSON(){var t,n;const i=this.offset-1,r=this.input.slice(0,this.start).split(`
`),o=r.length,s=this.text,a=s.split(`
`);return{level:this.level,start:{line:o,col:(((t=r.pop())===null||t===void 0?void 0:t.length)||1)-1,offset:this.start},end:{line:o+a.length-1,col:(((n=a.pop())===null||n===void 0?void 0:n.length)||1)-1,offset:i},text:s}}get text(){return this.input.slice(this.start,this.offset)}}var ff=function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},We=function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},nt,it,dr,hr,pr;class Z{constructor(t){it.set(this,void 0),ff(this,it,t,"f")}*scan(t){let n,i,r=We(this,it,"f").getCursor(t);for(yield*r.log({message:"beginning loop"});r.curr();){if(r=yield*r.scan(),!r){yield{error:!0,message:"did not generate a token"};break}try{i=yield*We(Z,nt,"m",pr).call(Z,r,i)}catch(o){r=!1,n=o;break}}return r?(yield*We(Z,nt,"m",hr).call(Z,r),r.getToken()):(yield*We(Z,nt,"m",dr).call(Z,n),!1)}getCursor(t){return new mn({input:t})}}nt=Z,it=new WeakMap,dr=function*(t){yield{success:!1,error:!0,message:{error:t}},yield!1},hr=function*(t){yield*t.log({success:!0,message:"ending loop"}),yield t.getToken()},pr=function*(t,n){const i=t?t.getToken():null;if(!i&&n)throw yield*t.log({error:!0,message:"token stream broke",info:{currentToken:i,prevCursor:n}}),new Error("token stream broke");if((n==null?void 0:n.offset)===t.offset)throw yield*t.log({error:!0,message:"cursor did not change positions"}),new Error("token stream broke");return t};function df(e){const t=e.curr();return t?/\d/.test(t):!1}function At(e){const t=e.curr();return t?/\d/.test(t):!1}function*me(e,t){const n=e.spawn(t);if(n.token({kind:"numeric"}),t)return yield*n.log({message:"not numeric",miss:"cannot follow prev",cursors:{start:e,prev:t}}),t;const{integral:i,fractional:r}=yield*hf(n);if(!(i.length||r.length))return yield*n.log({message:"not numeric",miss:"no integral or fractional components"}),!1;yield*n.log({message:"resolving numeric"});const o=i.length?parseInt(i.join("")):0,s=r.length?parseFloat(`.${r.join()}`):void 0,a={key:o+(s??0)};return n.token({head:a,integral:o,fractional:s}),n}function*hf(e){const t=[];{let i=df,r;for(;i(e);)!r&&(r=!0)&&(i=At,yield*e.log({message:"beginning numeric",info:{component:"integral"}})),t.push(e.curr()),yield*e.take()}const n=[];if(e.curr()==="."){yield*e.take();let i=!1,r=At;for(;r(e);)!i&&(i=!0)&&(r=At,yield*e.log({message:"continuing numeric",info:{component:"fractional"}})),n.push(e.curr()),yield*e.take()}return{integral:t,fractional:n}}function wr(e){return e?/[a-zA-Z]/.test(e):!1}function pf(e){return e?wr(e)||e==="_":!1}const Qn={name:"conceptual.open",key:"<",opposite:">",kind:"delimiter",open:!0},Zn={name:"locational.open",key:"(",opposite:")",kind:"delimiter",open:!0},ei={name:"structural.open",key:"{",opposite:"}",kind:"delimiter",open:!0},ti={name:"essential.open",key:"[",opposite:"]",kind:"delimiter",open:!0},ni={name:"conceptual.close",key:">",opposite:"<",kind:"delimiter",close:!0},ii={name:"locational.close",key:")",opposite:"(",kind:"delimiter",close:!0},ri={name:"structural.close",key:"}",opposite:"{",kind:"delimiter",close:!0},oi={name:"essential.close ",key:"]",opposite:"[",kind:"delimiter",close:!0},wf={"<":Qn,"(":Zn,"{":ei,"[":ti,_inverse:{">":Qn,")":Zn,"}":ei,"]":ti}},gf={">":ni,")":ii,"}":ri,"]":oi,_inverse:{"<":ni,"(":ii,"{":ri,"[":oi}},jt={open:wf,close:gf};function mf(e){const t=e.curr();return t?!!jt.open[t]:!1}function gr(e){return e.curr()===" "}function*T(e){const t=[];for(;gr(e);)t.push({key:e.curr()}),yield*e.take();return t}const mr={"*":{name:"salience",key:"*",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},"@":{name:"perspective",key:"@",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},":":{name:"binding",key:"@",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},"+":{name:"aggregation",key:"+",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},"-":{name:"reduction",key:"-",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},"=":{nodes:{">":{name:"transformation",key:"=>",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])}}}};function*yf(e,t=mr){let n=e.curr(),i=t[n];const r=[];for(;t[n];){if(r.push(n),i=t[n],!i.nodes){e.advance();break}t=i.nodes,yield*e.take(),n=e.curr()}return[i,r.join("")]}function*xf(e){let t=!1,n;return e.curr()==="_"&&(n=yield*e.take(),t=yield*e.scan([ye,me,ae])),[n,t]}function we(e){return function*(t){const n=t.spawn();n.token({kind:"operator"}),yield*n.log({message:"checking operator"});const[i,r]=yield*yf(n,e);if(i&&(n.token({proto:i}),n.token({kind:i.kind}),n.token({kind:i.name})),!i)return yield*n.log({message:"not an operator",miss:"no prototype",cursors:{start:t},info:{operators:e,curr:t.curr()}}),!1;const[o,s]=yield*xf(n);return n.token({body:[{key:r}],operators:o?[o]:void 0,tail:s?s.getToken():void 0}),n}}const vf=[ye,me,ae];function*Xe(e,t){const n=e.spawn(t);if(n.token({kind:"phrasal"}),yield*n.log({message:"checking phrasal"}),!t)return yield*n.log({message:"not phrasal",miss:"no head",cursors:{start:e,prev:t}}),!1;const{head:i,body:r,tail:o,operators:s}=yield*kf(n,t);return o?(yield*n.log({message:"resolving phrasal"}),n.token({head:i,body:r,tail:o,operators:s}),n):(yield*n.log({message:"not phrasal",miss:"no tail",cursors:{start:e,prev:t,cursor:n},info:{head:i,body:r,tail:o,operators:s}}),t??!1)}function*kf(e,t){const n=t&&t.getToken(),i=[],r=[];{let s=!1;for(;gr(e);){!s&&(s=!0)&&(yield*e.log({message:"beginning ordinal"}));const a=yield*T(e);r.push(a),yield*T(e);const u=yield*e.scan(vf),c=u?u.getToken():null;if(!c)break;i.push(c)}}const o=i.pop();return{head:n,body:i,tail:o,operators:r}}function _f(e){return e.curr()===","}const bf=[ye,me,ae,Xe],Sf={",":{name:"common",key:",",kind:"delimiter"}},Nf={";":{name:"ordinal",key:";",kind:"delimiter"},"\n":{name:"ordinal",key:";",kind:"delimiter"}};function*yn(e,t){const n=e.spawn(t);n.token({kind:"common"}),yield*n.log({message:"checking common"});const{head:i,body:r,tail:o,operators:s}=yield*Cf(n,t);return s.length?(yield*n.log({message:"resolving common"}),n.token({head:i,body:r,tail:o,operators:s}),n):(yield*n.log({message:"not common",miss:"no operators"}),t??!1)}function*Cf(e,t){yield*T(e);const n=t&&t.getToken(),i=[],r=[];let o=!1;for(;_f(e);){!o&&(o=!0)&&(yield*e.log({message:"beginning common"})),yield*T(e);const a=yield*e.scan([we(Sf)]),u=a==null?void 0:a.getToken();if(!u)break;r.push(u),yield*T(e);const c=yield*e.scan(bf);let l=c?c.getToken():null;l||(l=null),i.push(l),yield*T(e)}const s=i.pop();return{head:n,body:i,tail:s,operators:r}}function Mf(e){return e.curr()===";"||e.curr()===`
`}const Ef=[ye,me,ae,Xe,kt];function*kt(e,t,n=mr){var i;const r=e.spawn(t);r.token({kind:"operational"}),yield*r.log({message:"checking operational"});let{head:o,body:s,tail:a,operators:u,initialProto:c}=yield*Af(r,t,n);return u.length?(((i=c==null?void 0:c.kinds)===null||i===void 0?void 0:i.has("nominal"))&&!a&&(a=null),r.token({operators:u}),(c==null?void 0:c.kind)==="delimiter"?r:(u.length===1&&(r.token({kind:c.kind}),r.token({kind:c.name})),typeof a>"u"?(yield*r.log({message:"not operational",miss:"missing a tail component",cursor:r,info:{head:o,body:s,tail:a,tok:r.getToken()}}),r.token(!1),!1):(yield*r.log({message:"resolving operational",cursor:r}),!o&&!a&&r.token({kind:"conceptual"}),r.token({head:o,body:s,tail:a}),r))):(yield*r.log({message:"not operational",miss:"no operators"}),!1)}function*Af(e,t,n){const i=t&&t.getToken(),r=[],o=[];n[" "]||(yield*T(e));let s,a;for(;s=yield*e.scan([we(n)]);){if(!s)continue;if(!(s!=null&&s.getToken()))break;yield*e.log({message:"beginning operational"}),o.push(s.getToken());const c=s.getToken().proto;if(a=a||c,c.open){const d=yield*T(s);d.length&&r.push(d[0])}c.close||(yield*T(e));const l=yield*e.scan(Ef,c.close?s:void 0),f=l?l.getToken():null;if(!f)break;r.push(f),yield*T(e)}const u=r.pop();return{head:i,body:r,tail:u,operators:o,initialProto:a}}const Tf=[ye,me,ae,Xe,yn,kt];function*yr(e,t){const n=e.spawn(t);n.token({kind:"ordinal"}),yield*n.log({message:"checking ordinal"});const{head:i,body:r,tail:o,operators:s}=yield*Of(n,t);return s.length?(yield*n.log({message:"resolving ordinal"}),n.token({head:i,body:r,tail:o,operators:s}),n):(yield*n.log({message:"not ordinal",miss:"no operators"}),t??!1)}const If=we(Nf);function*Of(e,t){yield*T(e);const n=t&&t.getToken(),i=[],r=[];let o;{let a=!1;for(;Mf(e);){!a&&(a=!0)&&(yield*e.log({message:"beginning ordinal"})),yield*T(e);const u=yield*e.scan([If]),c=u==null?void 0:u.getToken();if(!c)break;!o&&r.push(o=[]),o.push(c),yield*T(e);const l=yield*e.scan(Tf);let f=l?l.getToken():null;f?o=null:f=null,i.push(f),yield*T(e)}}const s=i.pop();return{head:n,body:i,tail:s,operators:r}}const si={name:"open-conceptual",key:'"',opposite:'"',kind:"delimiter",open:!0},ai={name:"open-locational",key:"`",opposite:"`",kind:"delimiter",open:!0},ci={name:"close-conceptual",key:'"',opposite:'"',kind:"delimiter",close:!0},li={name:"close-locational",key:"`",opposite:"`",kind:"delimiter",close:!0},Df={'"':si,"`":ai,_inverse:{'"':si,"'":ai}},$f={'"':ci,"`":li,_inverse:{'"':ci,"`":li}},Kt={open:Df,close:$f};function Rf(e){const t=e.curr();return t?!!Kt.open[t]:!1}function xr(e){return e?e!=='"'&&e!=="`":!1}function Lf(e){return e?xr(e)||e==="_":!1}function*zf(e,t){const n=e.spawn(t);if(n.token({kind:"anything"}),yield*n.log({message:"checking anything"}),t)return yield*n.log({message:"not anything",miss:"cannot follow prev"}),t;const i=yield*Pf(n);if(!i.length)return yield*n.log({message:"not anything",miss:"no key"}),!1;yield*n.log({message:"resolving anything"});const r={key:i};return n.token({head:r}),n}function*Pf(e){const t=[];{let n,i=xr;for(;e.curr()&&i(e.curr());)!n&&(n=!0)&&(yield*e.log({message:"beginning anything"})),t.push(e.curr()),yield*e.take(),i=Lf}return t}const Ff=[zf];function*vr(e,t){const n=e.spawn(t);if(n.token({kind:"literal"}),yield*n.log({message:"checking literal"}),t)return yield*n.log({message:"not literal",miss:"prev"}),t;if(!Rf(e))return yield*n.log({message:"not literal",miss:"cursor cannot start literal"}),!1;const{head:i,body:r,tail:o}=yield*Bf(n);return yield*n.log({message:"resolving literal"}),n.token({head:i,body:r,tail:o}),n}function*Bf(e){var t,n;const i=Kt.open,r=yield*e.scan([we(i)]),o=r==null?void 0:r.getToken(),s=(t=o==null?void 0:o.label)===null||t===void 0?void 0:t.key,a=Kt.close._inverse[o.proto.key];if(!a)throw new Error("could not resolve type");yield*T(e);let u,c;const l=[];for(;e.curr();){!u&&(u=!0)&&(yield*e.log({message:"beginning literal"})),yield*T(e);const f=yield*e.scan([we({[a.key]:a})]),d=f==null?void 0:f.getToken(),h=(n=d==null?void 0:d.label)===null||n===void 0?void 0:n.key;if(d){if(h===s||!(h&&s)){c=d;break}l.push(d),yield*T(e)}const m=yield*e.scan(Ff);if(!m)break;l.push(m==null?void 0:m.getToken()),yield*T(e)}return{head:o,body:l,tail:c}}const qf=[ye,me,ae,vr,Xe,yn,yr,kt];function*ae(e,t){const n=e.spawn(t);if(n.token({kind:"container"}),yield*n.log({message:"checking container"}),t)return yield*n.log({message:"not container",miss:"prev"}),t;if(!mf(e))return yield*n.log({message:"not container",miss:"cursor cannot start container"}),!1;const{head:i,body:r,tail:o}=yield*Hf(n);return n.token({kind:i.proto.name.split(".")[0]}),yield*n.log({message:"resolving container"}),n.token({head:i,body:r,tail:o}),n}function*Hf(e){var t,n;const i=jt.open,r=yield*e.scan([we(i)]),o=r==null?void 0:r.getToken(),s=(t=o==null?void 0:o.label)===null||t===void 0?void 0:t.key,a=jt.close._inverse[o.proto.key];if(!a)throw new Error("could not resolve type");yield*T(e);let u,c;const l=[];for(;e.curr();){!u&&(u=!0)&&(yield*e.log({message:"beginning container"})),yield*T(e);const f=yield*e.scan([we({[a.key]:a})]),d=f==null?void 0:f.getToken(),h=(n=d==null?void 0:d.label)===null||n===void 0?void 0:n.key;if(d){if(h===s||!(h&&s)){c=d;break}l.push(d),yield*T(e)}const m=yield*e.scan(qf);if(!m)break;l.push(m==null?void 0:m.getToken()),yield*T(e)}return{head:o,body:l,tail:c}}function*Xf(e){var t;const n=new Map;let i;for(;(i=yield*e.scan([ae]))&&(i=i.getToken());){const r=(t=n.get(i.head.proto))!==null&&t!==void 0?t:[];r.push(i),n.set(i.head.proto.name,r)}return n}function*Uf(e){const t=yield*Xf(e);e.token({definition:t}),t.size&&e.token({body:[...t.values()]})}function*ye(e,t){const n=e.spawn(t);if(n.token({kind:"nominal"}),yield*n.log({message:"checking nominal"}),t)return yield*n.log({message:"not nominal",miss:"cannot follow prev"}),t;const i=yield*Yf(n);if(!i.length)return yield*n.log({message:"not nominal",miss:"no key"}),!1;yield*n.log({message:"resolving nominal"});const r={key:i};return n.token({head:r}),yield*Uf(n),n}function*Yf(e){const t=[];{let n,i=wr;for(;e.curr()&&i(e.curr());)!n&&(n=!0)&&(yield*e.log({message:"beginning nominal"})),t.push(e.curr()),yield*e.take(),i=pf}return t.join("")}const jf={literal:vr,container:ae,nominal:ye,numeric:me},Kf={operational:kt},Vf={phrasal:Xe,common:yn,ordinal:yr},Gf=Object.assign(Object.assign(Object.assign({},jf),Kf),Vf);class Jf extends ur{constructor(){super(...arguments),this.generators=Object.values(Gf),this.Cursor=mn}}function kr(e,{asGenerator:t=!1}={}){if(t)return i();let n;for(const r of i())n=r;return n;function*i(){const r=new Jf;yield*new Z(r).scan(e)}}function Wf(){const e=document.querySelector("h1"),t=e.innerText,n=document.querySelector("#main-wonder-button");e.tabIndex=0,e.onclick=s=>{s.target===e&&(s.stopPropagation(),o())},e.onkeydown=s=>{if(s.ctrlKey||s.metaKey){s.key==="c"&&navigator.clipboard.writeText(t);return}s.key!=="Shift"&&s.target===e&&s.key!=="Tab"&&(s.key===" "&&s.preventDefault(),!s.key.match(/\d/)&&n.click())};let i;function r(s=!0){document.removeEventListener("click",i),e.innerText=t,s&&e.focus()}function o(){const s=document.createElement("form"),a=document.createElement("input");a.onpaste=l=>{l.preventDefault();const f=l.clipboardData.getData("text/plain");nr(f)},a.value=t,a.id="h1-input",s.appendChild(a);const u=document.createElement("button");u.type="submit",u.innerText="submit";let c=!0;s.appendChild(u),e.innerHTML="",e.appendChild(s),a.focus(),a.setSelectionRange(0,a.value.length),u.onclick=l=>{l.preventDefault();const f=a.value,{liveStrings:d,nextDocumentMode:h,valueStrings:m}=lr(f);if(h==="spw"){c=!1,window.spwashi.spwEditor.value=m.join(`
`),L("spw",!1,!0);return}const p=m.join(`
`);if(!p)return;const w=JSON.parse(JSON.stringify(kr(p))),y=It();window.location.href=Ot(vi(w.identity),y,w.identity)},i=()=>{r(c)},u.onblur=()=>{r(c)},document.addEventListener("click",i)}n.onclick=s=>{s.stopPropagation(),o()}}function Qf(e){return null}function Zf(){return[{title:"Counter",x:0,width:0,calc:e=>e.width=window.spwashi.counter*1},{title:"Alpha",x:0,width:0,calc:e=>e.width=window.spwashi.simulation.alpha()*(window.spwashi.parameters.width||0)},{title:"Alpha Decay",x:0,width:0,calc:e=>e.width=window.spwashi.simulation.alphaDecay()*(window.spwashi.parameters.width||0)},{title:"Charge",x:0,width:0,calc:e=>{e.title="Charge: "+window.spwashi.parameters.forces.charge,e.width=window.spwashi.parameters.forces.charge}},{title:"Velocity Decay",x:0,width:0,calc:e=>e.width=window.spwashi.simulation.velocityDecay()*(window.spwashi.parameters.width||0)},{title:"Zoom",x:0,width:1,calc:e=>{var t;return e.title=`Zoom: ${((t=window.spwashi.zoomTransform)==null?void 0:t.k)||1}`}},{title:"Node Quantity",x:0,width:0,calc:e=>{let t=window.spwashi.nodes.length;return e.title="Node Count: "+t,e.width=t}},{title:"Node Queue Count",x:0,width:0,calc:e=>{const t=window.spwashi.parameters.nodes.count;e.title="Node Queue Count: "+t,e.width=t}}].map((e,t)=>(e.height=20,e.y=t*20,e))}function ed(){const e=Ie("svg#simulation"),t=e.append("g").attr("id","simulation-content");t.append("g").classed("rects",!0);const n=t.append("g").classed("links",!0),i=t.append("g").classed("nodes",!0);return{svg:e,wrapper:t,linksG:n,circlesG:i}}function td(e){e.attr("width",window.spwashi.parameters.width).attr("height",window.spwashi.parameters.height).attr("preserveAspectRatio","xMinYMin meet")}const nd=ed();function id(){window.spwashi.clearCachedNodes=()=>{window.spwashi.setItem("nodes",[])},window.spwashi.getNodeImageHref=Qf,window.spwashi.getNode=q.getNode,window.spwashi.nodes=[]}function rd(){window.spwashi.links=[]}function od(){window.spwashi.rects=Zf()}function sd(){window.spwashi.reinit=()=>console.log("reinit not yet defined"),td(nd.svg),id(),rd(),od(),window.spwashi.simulation=il(),un(()=>import("./reinit-0zGpNVes.js"),__vite__mapDeps([])).then(({reinit:e})=>{window.spwashi.reinit=e,e()})}function ad(){const e=document.querySelector("#query-parameters .value"),t=[...new URLSearchParams(window.location.search)].map(i=>i.join("=")).join(`
`);e.innerHTML=t,e.rows=t.split(`
`).length+1;const n=document.querySelector("#query-parameters button.go");n.onclick=i=>{const r=new URLSearchParams(e.value.split(`
`).map(o=>o.split("=")));ze(r),i.shiftKey&&(window.location="?"+r)}}const cd=e=>{const t=e||window.spwashi.parameters.nodes.count,n=[...Array(t)].map(i=>({name:"boon",identity:Date.now()+Math.random()}));return z(...n),window.spwashi.reinit(),n};function ld(){const e=window.spwashi.simulation;if(!e){const a="no force simulation initialized";throw alert(a),new Error(a)}const t=document.querySelector("#controls .tick");t.onclick=()=>{window.spwashi.tick()};const n=document.querySelector("#controls .start");n.onclick=()=>{e.restart()};const i=document.querySelector("#controls .stop");i.onclick=()=>{e.stop()};const r=document.querySelector("#controls .reinit");r.onclick=()=>{window.spwashi.reinit()};const o=document.querySelector("#controls .clear-fixed-positions");o.onclick=()=>{D(a=>{a.fx=void 0,a.fy=void 0})};const s=document.querySelector("#controls .generate-nodes");s.onclick=cd}const ud=e=>{const t=[],n=kr(e,{asGenerator:!0});for(let s of n)mn.isCharacterCursor(s)&&t.push(s.getToken());const i=ge(),r={};return t.forEach(s=>r[s.identity]=r[s.identity]||s),_r(i,Object.keys(r),r).map(s=>r[s])};function _r(e,t,n){window.spwashi.perspectiveMap.has(e)||window.spwashi.perspectiveMap.set(e,{identities:new Set,tokenObj:{}});const i=window.spwashi.perspectiveMap.get(e),r=t.filter(o=>!i.identities.has(o));return r.forEach(o=>{i.identities.add(o)}),Object.assign(i.tokenObj,n),r}function fd(e){return Object.fromEntries(e.map(t=>[t,{identity:t}]))}function dd(){wn(),window.spwashi.perspectiveMap=new Map;const e=ge(),t=pi(r=>r.identity);_r(e,t,fd(t));const n=rf();window.spwashi.spwEditor=n;const i=document.querySelector("#parse-spw");i.onclick=()=>{const{nextDocumentMode:r,liveStrings:o,valueStrings:s}=lr(n.value);L(r,!1),n.value=s.join(`
`);const a=o.filter(l=>typeof l=="string").join(`
`);window.spwashi.setItem("parameters.spw-parse-field",a);const u=ud(a),c=JSON.parse(JSON.stringify(u));c.forEach(q.processNode),z(...c),window.spwashi.reinit(),Pe().focus()}}function hd(e){ir(),Sr(e),dd(),Rr(),Vl(),ad(),ou(),ld(),cr(),un(()=>import("./mode-mapfilter-gP1nmAPo.js"),__vite__mapDeps([])).then(({initializeMapFilterMode:t})=>{t()})}function pd(){window.spwashi={},Nr(),wd(),ze(new URLSearchParams(window.location.search)),Pe(),Wf(),hd(window.spwashi.initialMode)}function wd(){sd(),gd(),Ar(),lu(),window.spwashi.counter=0,window.spwashi.modeOrder=["reflex","color","map","filter","node","query","debug","story","spw"],window.location.pathname==="/help"&&(wi(),window.spwashi.spwEditor.value=window.spwashi.getItem("help","focal.root")||"",L("spw",!1,!0))}function gd(){window.spwashi.__session=window.spwashi.__session||{i:0},window.spwashi.setItem=(e,t,n=null)=>{window.localStorage.setItem(ui(e,n),JSON.stringify(t||null))},window.spwashi.getItem=(e,t=null)=>{const n=window.localStorage.getItem(ui(e,t));if(n)return JSON.parse(n||"{}")}}function ui(e,t=null){return t||(t=window.spwashi.parameterKey),t+"@"+e}pd();export{Wl as E,Ul as M,q as N,fn as S,Iu as a,L as b,md as c,yd as d,xd as e,D as f,zr as g,cd as h,td as i,It as j,dn as k,jl as l,pi as m,H as n,vd as o,z as p,Zi as q,ln as r,nd as s,hn as t,eu as u,pu as v};
//# sourceMappingURL=index-hcXEp1Oj.js.map
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}